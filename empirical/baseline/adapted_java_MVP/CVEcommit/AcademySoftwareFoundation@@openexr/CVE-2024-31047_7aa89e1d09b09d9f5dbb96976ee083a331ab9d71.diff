commit 7aa89e1d09b09d9f5dbb96976ee083a331ab9d71
Author: xiaoxiaoafeifei <zhailiangliang@loongson.cn>
Date:   Wed Mar 20 00:09:05 2024 +0800

    prevent integer overflows in file exrmultipart.cpp (#1681)
    
    Signed-off-by: ZhaiLiangliang <zhailiangliang@loongson.cn>

diff --git a/src/bin/exrmultipart/exrmultipart.cpp b/src/bin/exrmultipart/exrmultipart.cpp
index a657d40a..507fb875 100644
--- a/src/bin/exrmultipart/exrmultipart.cpp
+++ b/src/bin/exrmultipart/exrmultipart.cpp
@@ -289,11 +289,17 @@ convert (
     }
 
     Box2i dataWindow  = infile.header (0).dataWindow ();
-    int   pixel_count = (dataWindow.size ().y + 1) * (dataWindow.size ().x + 1);
-    int   pixel_width = dataWindow.size ().x + 1;
+    //
+    // use int64_t for dimensions, since possible overflow int storage
+    //
+    int64_t pixel_count = (static_cast<int64_t>(dataWindow.size ().y) + 1) * (static_cast<int64_t>(dataWindow.size ().x) + 1);
+    int64_t pixel_width = static_cast<int64_t>(dataWindow.size ().x) + 1;
 
+    //
     // offset in pixels between base of array and 0,0
-    int pixel_base = dataWindow.min.y * pixel_width + dataWindow.min.x;
+    // use int64_t for dimensions, since dataWindow.min.y * pixel_width could overflow int storage
+    //
+    int64_t pixel_base = static_cast<int64_t>(dataWindow.min.y) * pixel_width + static_cast<int64_t>(dataWindow.min.x);
 
     vector<vector<char>> channelstore (channel_count);
 
