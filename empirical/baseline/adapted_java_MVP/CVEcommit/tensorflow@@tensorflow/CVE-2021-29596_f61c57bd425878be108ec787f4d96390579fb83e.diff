commit f61c57bd425878be108ec787f4d96390579fb83e
Author: Mihai Maruseac <mihaimaruseac@google.com>
Date:   Wed Apr 28 12:57:00 2021 -0700

    Prevent division by 0
    
    PiperOrigin-RevId: 370966645
    Change-Id: I831bfd96c7eb77b02d7ebb744335f59f6e5728cb

diff --git a/tensorflow/lite/kernels/embedding_lookup.cc b/tensorflow/lite/kernels/embedding_lookup.cc
index d865f69eb9b..092868d5a6a 100644
--- a/tensorflow/lite/kernels/embedding_lookup.cc
+++ b/tensorflow/lite/kernels/embedding_lookup.cc
@@ -71,6 +71,10 @@ TfLiteStatus EvalSimple(TfLiteContext* context, TfLiteNode* node,
                         const TfLiteTensor* lookup, const TfLiteTensor* value,
                         TfLiteTensor* output) {
   const int row_size = SizeOfDimension(value, 0);
+  if (row_size == 0) {
+    // Propagate empty tensor if input is empty
+    return kTfLiteOk;
+  }
   const int row_bytes = value->bytes / row_size;
 
   char* output_raw = GetTensorData<char>(output);
