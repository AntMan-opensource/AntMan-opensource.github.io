commit c2b31ff2d3151acb230edc3f5b1832d2c713a9e0
Author: Mihai Maruseac <mihaimaruseac@google.com>
Date:   Mon Nov 8 10:14:10 2021 -0800

    Remove a `DCHECK`-fail, log an error instead.
    
    `DCHECK` in debug mode results in crashes. TensorFlow has had multiple vulnerabilities due to this.
    
    Outside of debug mode, `DCHECK` is a no-op.
    
    A better alternative is to report an error to the log buffer and continue. This should happen both in debug mode and in prod mode.
    
    PiperOrigin-RevId: 408375925
    Change-Id: Id5b3e19c73f3fbe0cc4bba26ca44ff9607bb6356

diff --git a/tensorflow/core/framework/op_def_util.cc b/tensorflow/core/framework/op_def_util.cc
index dcbe5f38ce8..6127913d9ba 100644
--- a/tensorflow/core/framework/op_def_util.cc
+++ b/tensorflow/core/framework/op_def_util.cc
@@ -821,9 +821,10 @@ bool RepeatedAttrDefEqual(
     const protobuf::RepeatedPtrField<OpDef::AttrDef>& a2) {
   std::unordered_map<string, const OpDef::AttrDef*> a1_set;
   for (const OpDef::AttrDef& def : a1) {
-    DCHECK(a1_set.find(def.name()) == a1_set.end())
-        << "AttrDef names must be unique, but '" << def.name()
-        << "' appears more than once";
+    if (a1_set.find(def.name()) != a1_set.end()) {
+      LOG(ERROR) << "AttrDef names must be unique, but '" << def.name()
+                 << "' appears more than once";
+    }
     a1_set[def.name()] = &def;
   }
   for (const OpDef::AttrDef& def : a2) {
