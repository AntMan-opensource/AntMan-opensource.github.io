commit 80a4dc55f4d2fa33c2b36a99406500726d3faaef
Author: John Thacker <johnthacker@gmail.com>
Date:   Thu Sep 21 21:09:05 2023 -0400

    BGP: Optlen must be a 16 bit integer now
    
    The extended option length in RFC 9072 must be stored in
    a 16 bit integer to avoid stepping the offset by the wrong
    value due to overflow.
    
    Fixup commit a9a62ff576ae79e0d6afb3214a5d409ec4cdf9d7

diff --git a/epan/dissectors/packet-bgp.c b/epan/dissectors/packet-bgp.c
index 0f7f22816f..75d9fc9a4e 100644
--- a/epan/dissectors/packet-bgp.c
+++ b/epan/dissectors/packet-bgp.c
@@ -8441,7 +8441,7 @@ dissect_bgp_capability_item(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo,
 static void
 dissect_bgp_open(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo)
 {
-    guint8          optlen;    /* Option Length */
+    uint16_t        optlen;    /* Option Length */
     int             ptype;     /* parameter type        */
     int             plen;      /* parameter length      */
     int             cend;      /* capabilities end      */
@@ -11439,10 +11439,10 @@ proto_register_bgp(void)
           NULL, 0x0, "The total length of the Optional Parameters field in octets", HFILL }},
       { &hf_bgp_open_opt_extension,
         { "Optional Parameter Extension", "bgp.open.opt.extension", FT_NONE, BASE_NONE,
-          NULL, 0x0, "Optional Parameters Extension dedetected", HFILL }},
+          NULL, 0x0, "Optional Parameters Extension detected", HFILL }},
       { &hf_bgp_open_opt_extension_mark,
         { "Extension Mark", "bgp.open.opt.extension.mark", FT_UINT8, BASE_DEC,
-          NULL, 0x0, "Optional Parameters Extension dedetected", HFILL }},
+          NULL, 0x0, "Optional Parameters Extension detected", HFILL }},
       { &hf_bgp_open_opt_extension_len,
         { "Extended Length", "bgp.open.opt.extension_len", FT_UINT16, BASE_DEC,
           NULL, 0x0, "The total extended length of the Optional Parameters field in octets", HFILL }},
