commit d7a8bdd7bb33cf8e58bc01b4a4f2ea5466f8c6b3
Author: Cristy <urban-warrior@imagemagick.org>
Date:   Sat Apr 1 07:33:24 2023 -0400

    possible heap buffer overflow (https://github.com/ImageMagick/ImageMagick/security/advisories/GHSA-35q2-86c7-9247)

diff --git a/coders/tiff.c b/coders/tiff.c
index a437421bc..1d21ee7a4 100644
--- a/coders/tiff.c
+++ b/coders/tiff.c
@@ -1903,8 +1903,8 @@ static Image *ReadTIFFImage(const ImageInfo *image_info,
         /*
           Convert stripped TIFF image.
         */
-        extent=4*MagickMax(image->columns*(samples_per_pixel+extra_samples)*
-          (image->depth+7)/8,(size_t) TIFFStripSize(tiff));
+        extent=MagickMax(sizeof(uint32),(samples_per_pixel+extra_samples)*
+          (image->depth+7)/8)*image->columns*rows_per_strip;
         strip_pixels=(unsigned char *) AcquireQuantumMemory(extent,
           sizeof(*strip_pixels));
         if (strip_pixels == (unsigned char *) NULL)
