commit aa673b2e4defc7cad5bec16c4fc8324f71e531f1
Author: Cristy <urban-warrior@imagemagick.org>
Date:   Sun Sep 24 07:28:19 2023 -0400

    check for BMP file size, poc provided by Hardik Shah of Vehere (Dawn Treaders team)

diff --git a/coders/bmp.c b/coders/bmp.c
index 94ec6628f..7e36d4f48 100644
--- a/coders/bmp.c
+++ b/coders/bmp.c
@@ -695,6 +695,9 @@ static Image *ReadBMPImage(const ImageInfo *image_info,ExceptionInfo *exception)
       }
     if (bmp_info.size > 124)
       ThrowReaderException(CorruptImageError,"ImproperImageHeader");
+    if ((bmp_info.file_size != 0) &&
+        ((MagickSizeType) bmp_info.file_size > GetBlobSize(image)))
+      ThrowReaderException(CorruptImageError,"ImproperImageHeader");
     if (bmp_info.offset_bits < bmp_info.size)
       ThrowReaderException(CorruptImageError,"ImproperImageHeader");
     bmp_info.offset_bits=MagickMax(14+bmp_info.size,bmp_info.offset_bits);
