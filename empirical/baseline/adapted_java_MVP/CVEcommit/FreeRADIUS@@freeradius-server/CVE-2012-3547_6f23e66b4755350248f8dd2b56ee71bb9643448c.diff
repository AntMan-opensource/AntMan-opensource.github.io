commit 6f23e66b4755350248f8dd2b56ee71bb9643448c
Author: Alan T. DeKok <aland@freeradius.org>
Date:   Mon Sep 10 08:20:13 2012 +0200

    Fix CVE-2012-3547.  Found by Timo Warns.

diff --git a/src/main/tls.c b/src/main/tls.c
index beb48216b7..ab061bc9a7 100644
--- a/src/main/tls.c
+++ b/src/main/tls.c
@@ -1380,7 +1380,7 @@ int cbtls_verify(int ok, X509_STORE_CTX *ctx)
 	buf[0] = '\0';
 	asn_time = X509_get_notAfter(client_cert);
 	if (identity && (lookup <= 1) && asn_time &&
-	    (asn_time->length < MAX_STRING_LEN)) {
+	    (asn_time->length < sizeof(buf))) {
 		memcpy(buf, (char*) asn_time->data, asn_time->length);
 		buf[asn_time->length] = '\0';
 		pairadd(certs,
