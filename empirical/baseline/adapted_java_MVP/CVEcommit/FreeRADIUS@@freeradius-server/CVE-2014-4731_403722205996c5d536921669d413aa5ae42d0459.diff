commit 403722205996c5d536921669d413aa5ae42d0459
Author: jvoisin <julien.voisin@dustri.org>
Date:   Mon Jul 14 19:31:02 2014 -0400

    Constant time memory comparison.
    
    CVE-2014-4731.
    
    Non-constant time comparisons usually require millions of packets
    in order to get enough statistics.  This is VERY hard to do with
    WiFi or wired 802.1X.  The delays on switch port open / close
    are on the order of seconds.

diff --git a/src/modules/rlm_eap/types/rlm_eap_pwd/rlm_eap_pwd.c b/src/modules/rlm_eap/types/rlm_eap_pwd/rlm_eap_pwd.c
index 7222cb577a..ecaeb702e4 100644
--- a/src/modules/rlm_eap/types/rlm_eap_pwd/rlm_eap_pwd.c
+++ b/src/modules/rlm_eap/types/rlm_eap_pwd/rlm_eap_pwd.c
@@ -370,7 +370,7 @@ static int mod_authenticate (void *arg, eap_handler_t *handler)
 		if ((id->prf != EAP_PWD_DEF_PRF) ||
 		    (id->random_function != EAP_PWD_DEF_RAND_FUN) ||
 		    (id->prep != EAP_PWD_PREP_NONE) ||
-		    (memcmp(id->token, (char *)&pwd_session->token, 4)) ||
+		    (CRYPTO_memcmp(id->token, (char *)&pwd_session->token, 4)) ||
 		    (id->group_num != ntohs(pwd_session->group_num))) {
 			RDEBUG2("pwd id response is invalid");
 			return 0;
@@ -561,7 +561,7 @@ static int mod_authenticate (void *arg, eap_handler_t *handler)
 			RDEBUG2("pwd exchange cannot compute peer's confirm");
 			return 0;
 		}
-		if (memcmp(peer_confirm, buf, SHA256_DIGEST_LENGTH)) {
+		if (CRYPTO_memcmp(peer_confirm, buf, SHA256_DIGEST_LENGTH)) {
 			RDEBUG2("pwd exchange fails: peer confirm is incorrect!");
 			return 0;
 		}
