commit 367cf59651605043ddabf3ed1b1bc7e7e5e775dc
Author: Gordon Tetlow <gordon@FreeBSD.org>
Date:   Thu Sep 7 18:54:54 2017 +0000

    Fix an incorrectly used conditional causing a stack buffer overflow.
    
    Reported by:    Thomas Jarosch of Intra2net AG
    Reviewed by:    emaste, jhb
    Security:       CVE-2017-1000249

diff --git a/contrib/file/src/readelf.c b/contrib/file/src/readelf.c
index 90dae392f699..f3212871d625 100644
--- a/contrib/file/src/readelf.c
+++ b/contrib/file/src/readelf.c
@@ -509,7 +509,7 @@ do_bid_note(struct magic_set *ms, unsigned char *nbuf, uint32_t type,
     size_t noff, size_t doff, int *flags)
 {
 	if (namesz == 4 && strcmp((char *)&nbuf[noff], "GNU") == 0 &&
-	    type == NT_GNU_BUILD_ID && (descsz >= 4 || descsz <= 20)) {
+	    type == NT_GNU_BUILD_ID && (descsz >= 4 && descsz <= 20)) {
 		uint8_t desc[20];
 		const char *btype;
 		uint32_t i;
