commit 6ab923cbca8759503a08683a5978b9ebf5efd607
Author: Mark Johnston <markj@FreeBSD.org>
Date:   Tue Feb 23 17:01:29 2021 -0500

    pam_login_access: Fix negative entry matching logic
    
    PR:             252194
    Approved by:    so
    Security:       CVE-2020-25580
    Security:       FreeBSD-SA-21:03.pam_login_access

diff --git a/lib/libpam/modules/pam_login_access/login_access.c b/lib/libpam/modules/pam_login_access/login_access.c
index 9496081d362e..719808858dac 100644
--- a/lib/libpam/modules/pam_login_access/login_access.c
+++ b/lib/libpam/modules/pam_login_access/login_access.c
@@ -137,10 +137,10 @@ list_match(char *list, const char *item,
     if (match != NO) {
 	while ((tok = strtok((char *) 0, listsep)) && strcmp(tok, "EXCEPT")) {
 	     /* VOID */ ;
-	    if (tok == NULL || list_match((char *) 0, item, match_fn,
-		login_access_opts) == NO) {
+	}
+	if (tok == NULL ||
+	    list_match((char *) 0, item, match_fn, login_access_opts) == NO) {
 		return (match);
-	    }
 	}
     }
     return (NO);
