commit c9d2719027821229f5ca9a5194040713c3d0409c
Author: Gleb Smirnoff <glebius@FreeBSD.org>
Date:   Tue May 17 22:28:42 2016 +0000

    Use unsigned version of min() when handling arguments of SETFKEY ioctl.
    
    Submitted by:   C Turt <cturt hardenedbsd.org>
    Security:       SA-16:18
    Security:       CVE-2016-1886

diff --git a/sys/dev/kbd/kbd.c b/sys/dev/kbd/kbd.c
index 389ef7575bb5..6a386088ff1b 100644
--- a/sys/dev/kbd/kbd.c
+++ b/sys/dev/kbd/kbd.c
@@ -996,7 +996,7 @@ genkbd_commonioctl(keyboard_t *kbd, u_long cmd, caddr_t arg)
 			splx(s);
 			return (error);
 		}
-		kbd->kb_fkeytab[fkeyp->keynum].len = imin(fkeyp->flen, MAXFK);
+		kbd->kb_fkeytab[fkeyp->keynum].len = min(fkeyp->flen, MAXFK);
 		bcopy(fkeyp->keydef, kbd->kb_fkeytab[fkeyp->keynum].str,
 		    kbd->kb_fkeytab[fkeyp->keynum].len);
 		break;
