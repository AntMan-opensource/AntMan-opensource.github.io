commit d366f891b12ce2802752fe6cde1e39e5003eb656
Author: Ed Maste <emaste@FreeBSD.org>
Date:   Tue Jan 15 15:35:14 2019 +0000

    scp: disallow empty or current directory
    
    Obtained from:  OpenBSD scp.c 1.198
    Security:       CVE-2018-20685
    Sponsored by:   The FreeBSD Foundation

diff --git a/crypto/openssh/scp.c b/crypto/openssh/scp.c
index 60682c68769b..817880206684 100644
--- a/crypto/openssh/scp.c
+++ b/crypto/openssh/scp.c
@@ -1106,7 +1106,8 @@ sink(int argc, char **argv)
 			SCREWUP("size out of range");
 		size = (off_t)ull;
 
-		if ((strchr(cp, '/') != NULL) || (strcmp(cp, "..") == 0)) {
+		if (*cp == '\0' || strchr(cp, '/') != NULL ||
+		    strcmp(cp, ".") == 0 || strcmp(cp, "..") == 0) {
 			run_err("error: unexpected filename: %s", cp);
 			exit(1);
 		}
