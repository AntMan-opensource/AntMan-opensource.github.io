commit e03f0571759059147077c3c20690a21239b3dfad
Author: Xin LI <delphij@FreeBSD.org>
Date:   Thu Dec 10 21:23:46 2009 +0000

    Correct a DoS issue when processing XML document with malformed
    UTF-8 sequences.
    
    Obtained from:  expat CVS (revisions 1.14 and 1.15)
    Security:       CVE-2009-3560

diff --git a/lib/xmltok_impl.c b/lib/xmltok_impl.c
index 126881925222..16dfb85f031e 100644
--- a/lib/xmltok_impl.c
+++ b/lib/xmltok_impl.c
@@ -1744,7 +1744,7 @@ PREFIX(updatePosition)(const ENCODING *enc,
                        const char *end,
                        POSITION *pos)
 {
-  while (ptr != end) {
+  while (ptr < end) {
     switch (BYTE_TYPE(enc, ptr)) {
 #define LEAD_CASE(n) \
     case BT_LEAD ## n: \
