commit 54e9e4e72d711fb41f88f793f6c64df1126112f9
Author: Ed Maste <emaste@FreeBSD.org>
Date:   Tue Aug 6 16:09:06 2019 +0000

    bsnmp: add asn1 message length validation
    
    admbugs:        780
    Submitted by:   Guido Vranken, bz
    Reported by:    Guido Vranken
    Security:       CVE-2019-5610

diff --git a/contrib/bsnmp/lib/asn1.c b/contrib/bsnmp/lib/asn1.c
index 03b5662ed22c..c96ea8c84ff6 100644
--- a/contrib/bsnmp/lib/asn1.c
+++ b/contrib/bsnmp/lib/asn1.c
@@ -100,6 +100,11 @@ asn_get_header(struct asn_buf *b, u_char *type, asn_len_t *len)
 		*len = *b->asn_cptr++;
 		b->asn_len--;
 	}
+	if (*len > b->asn_len) {
+		asn_error(b, "len %u exceeding asn_len %u", *len, b->asn_len);
+		return (ASN_ERR_EOBUF);
+	}
+	
 	return (ASN_ERR_OK);
 }
 
