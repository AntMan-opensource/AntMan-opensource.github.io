commit 2425f5e9128102c8e6e473567ad6759a55be5b02
Author: Mark Johnston <markj@FreeBSD.org>
Date:   Mon Apr 5 17:19:15 2021 -0400

    mount: Disallow mounting over a jail root
    
    Discussed with: jamie
    Approved by:    so
    Security:       CVE-2020-25584
    Security:       FreeBSD-SA-21:10.jail_mount

diff --git a/sys/kern/vfs_mount.c b/sys/kern/vfs_mount.c
index e20e1520f677..7dc6b795eefd 100644
--- a/sys/kern/vfs_mount.c
+++ b/sys/kern/vfs_mount.c
@@ -956,10 +956,10 @@ vfs_domount_first(
 
 	/*
 	 * If the jail of the calling thread lacks permission for this type of
-	 * file system, deny immediately.
+	 * file system, or is trying to cover its own root, deny immediately.
 	 */
-	if (jailed(td->td_ucred) && !prison_allow(td->td_ucred,
-	    vfsp->vfc_prison_flag)) {
+	if (jailed(td->td_ucred) && (!prison_allow(td->td_ucred,
+	    vfsp->vfc_prison_flag) || vp == td->td_ucred->cr_prison->pr_root)) {
 		vput(vp);
 		return (EPERM);
 	}
