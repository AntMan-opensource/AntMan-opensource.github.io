commit 29a073ad297a0954f5e865264e24755d0ffe53ed
Author: Timo Kokkonen <tjko@iki.fi>
Date:   Wed Mar 1 19:34:53 2023 -0800

    Fix possible read past the end of inbuffer (when parsing corrupt JPEG).

diff --git a/jpegoptim.c b/jpegoptim.c
index 93b5c99..bf678d3 100644
--- a/jpegoptim.c
+++ b/jpegoptim.c
@@ -1090,7 +1090,7 @@ binary_search_loop:
 			fprintf(log_fh,csv ? "skipped\n" : "skipped.\n");
 		if (stdout_mode) {
 			set_filemode_binary(stdout);
-			if (fwrite(inbuffer,insize,1,stdout) != 1)
+			if (fwrite(inbuffer, inbufferused, 1, stdout) != 1)
 				fatal("%s, write failed to stdout",
 					(stdin_mode ? "stdin" : filename));
 		}
