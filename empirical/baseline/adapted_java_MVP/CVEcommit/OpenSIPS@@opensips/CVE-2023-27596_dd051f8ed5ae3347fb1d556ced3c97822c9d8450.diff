commit dd051f8ed5ae3347fb1d556ced3c97822c9d8450
Author: Bogdan-Andrei Iancu <bogdan@opensips.org>
Date:   Thu Mar 24 11:42:00 2022 +0200

    [sipmsgops] fix codec_delete_XX() parsing
    
    Issue discovered during OpenSIPS Security Audit 2021/2022,
    by Alfred Farrugia & Sandro Gauci (Enable Security)
    
    https://github.com/OpenSIPS/opensips/security/advisories/GHSA-3ghx-j39m-cw4f

diff --git a/modules/sipmsgops/codecs.c b/modules/sipmsgops/codecs.c
index 81a276767..e292a81f9 100644
--- a/modules/sipmsgops/codecs.c
+++ b/modules/sipmsgops/codecs.c
@@ -559,7 +559,7 @@ static int stream_process(struct sip_msg * msg, struct sdp_stream_cell *cell,
 					/* when trimming the very last payload, avoid trailing ws */
 					if (cur == lmp->u.value + lmp->len) {
 						tmp = found.s;
-						while (*(--tmp) == ' ') {
+						while (tmp>lmp->u.value && *(--tmp) == ' ') {
 							found.s--;
 							found.len++;
 						}
