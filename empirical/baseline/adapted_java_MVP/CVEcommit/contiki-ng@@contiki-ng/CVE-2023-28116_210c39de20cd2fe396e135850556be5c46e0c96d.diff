commit 210c39de20cd2fe396e135850556be5c46e0c96d
diff --git a/os/net/mac/ble/ble-l2cap.c b/os/net/mac/ble/ble-l2cap.c
index dbd1ffc77..c645e75dc 100644
--- a/os/net/mac/ble/ble-l2cap.c
+++ b/os/net/mac/ble/ble-l2cap.c
@@ -593,6 +593,10 @@ PROCESS_THREAD(ble_l2cap_tx_process, ev, data)
         }
 
         /* copy payload */
+        if(data_len > PACKETBUF_SIZE - packetbuf_hdrlen()) {
+          LOG_WARN("Not enough packetbuf space to copy buffer\n");
+          continue;
+        }
         memcpy(packetbuf_dataptr(),
                &channel->tx_buffer.sdu[channel->tx_buffer.current_index],
                data_len);
diff --git a/os/net/mac/ble/ble-l2cap.h b/os/net/mac/ble/ble-l2cap.h
index 73dfa18a5..e997f60a6 100644
--- a/os/net/mac/ble/ble-l2cap.h
+++ b/os/net/mac/ble/ble-l2cap.h
@@ -73,7 +73,11 @@
 #ifdef BLE_L2CAP_CONF_NODE_MTU
 #define BLE_L2CAP_NODE_MTU      BLE_L2CAP_CONF_NODE_MTU
 #else
-#define BLE_L2CAP_NODE_MTU              1280
+#define BLE_L2CAP_NODE_MTU      PACKETBUF_SIZE
+#endif
+
+#if BLE_L2CAP_NODE_MTU > PACKETBUF_SIZE
+#error BLE_L2CAP_NODE_MTU exceeds the PACKETBUF_SIZE
 #endif
 
 /* the max. supported L2CAP fragment length */
