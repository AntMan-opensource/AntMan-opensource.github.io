commit 34c52c20be0425adadd52a3a6bbb063f22555965
Author: Nicolas Tsiftes <nicolas.tsiftes@ri.se>
Date:   Mon Jul 10 19:55:38 2023 +0200

    Check whether we have a full TCP header before checking if the SYN flag is set.

diff --git a/os/net/ipv6/tcpip.c b/os/net/ipv6/tcpip.c
index a0b32a91a..5e4980f25 100644
--- a/os/net/ipv6/tcpip.c
+++ b/os/net/ipv6/tcpip.c
@@ -153,7 +153,8 @@ check_for_tcp_syn(void)
      this timer.  This function is called for every incoming IP packet
      to check for such SYNs. */
 #define TCP_SYN 0x02
-  if(UIP_IP_BUF->proto == UIP_PROTO_TCP &&
+  if(uip_len >= UIP_IPTCPH_LEN + uip_ext_len &&
+     UIP_IP_BUF->proto == UIP_PROTO_TCP &&
      (UIP_TCP_BUF->flags & TCP_SYN) == TCP_SYN) {
     start_periodic_tcp_timer();
   }
