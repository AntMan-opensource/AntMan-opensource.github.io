commit 1f3d63eed109748f297a89622eb2df7a84a54644
Author: lee-emqx <lihj@emqx.io>
Date:   Fri Apr 14 17:44:03 2023 +0800

    * FIX [mqtt_parser.c] Fixed issue 1155.

diff --git a/src/sp/protocol/mqtt/mqtt_parser.c b/src/sp/protocol/mqtt/mqtt_parser.c
index 92a47f27..ff9a831d 100644
--- a/src/sp/protocol/mqtt/mqtt_parser.c
+++ b/src/sp/protocol/mqtt/mqtt_parser.c
@@ -299,7 +299,7 @@ copyn_str(const uint8_t *src, uint32_t *pos, int *str_len, int limit)
 	*str_len      = 0;
 	uint8_t *dest = NULL;
 
-	if (!src || !pos) {
+	if (!src || !pos || limit < 2) {
 		*str_len = 0;
 		return NULL;
 	}
