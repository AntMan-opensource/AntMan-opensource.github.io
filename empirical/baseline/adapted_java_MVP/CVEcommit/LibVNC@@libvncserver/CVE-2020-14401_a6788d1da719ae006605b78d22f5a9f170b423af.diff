commit a6788d1da719ae006605b78d22f5a9f170b423af
Author: Tobias Junghans <tobydox@veyon.io>
Date:   Wed May 27 12:18:44 2020 +0200

    libvncserver: scale: cast to 64 bit before shifting
    
    Since pixel_value is 64 bit the data type of the shift operand should
    be 64 bit too to prevent integer overflows.

diff --git a/libvncserver/scale.c b/libvncserver/scale.c
index a5cdf2ba..39ccb473 100644
--- a/libvncserver/scale.c
+++ b/libvncserver/scale.c
@@ -210,7 +210,7 @@ void rfbScaledScreenUpdateRect(rfbScreenInfoPtr screen, rfbScreenInfoPtr ptr, in
              default:
                /* fixme: endianness problem? */
                for (z = 0; z < bytesPerPixel; z++)
-                 pixel_value += (srcptr2[z] << (8 * z));
+                 pixel_value += ((unsigned long)srcptr2[z] << (8 * z));
                 break;
               }
               /*
