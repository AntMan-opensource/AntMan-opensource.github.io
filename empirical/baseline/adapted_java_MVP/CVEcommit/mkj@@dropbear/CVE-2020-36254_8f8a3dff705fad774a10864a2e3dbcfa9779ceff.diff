commit 8f8a3dff705fad774a10864a2e3dbcfa9779ceff
Author: Haelwenn Monnier <contact+github.com@hacktivis.me>
Date:   Mon May 25 14:54:29 2020 +0200

    scp.c: Port OpenSSH CVE-2018-20685 fix (#80)

diff --git a/scp.c b/scp.c
index 742ae00..7b8e7d2 100644
--- a/scp.c
+++ b/scp.c
@@ -935,7 +935,8 @@ sink(int argc, char **argv)
 			size = size * 10 + (*cp++ - '0');
 		if (*cp++ != ' ')
 			SCREWUP("size not delimited");
-		if ((strchr(cp, '/') != NULL) || (strcmp(cp, "..") == 0)) {
+		if (*cp == '\0' || strchr(cp, '/') != NULL ||
+		    strcmp(cp, ".") == 0 || strcmp(cp, "..") == 0) {
 			run_err("error: unexpected filename: %s", cp);
 			exit(1);
 		}
