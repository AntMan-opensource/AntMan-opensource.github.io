commit 9bd48f0dbd64fb94dc2b5b05238fde0bfdd4ff3f
diff --git a/libtiff/tif_dir.c b/libtiff/tif_dir.c
index 3d57341f..c3a7a418 100644
--- a/libtiff/tif_dir.c
+++ b/libtiff/tif_dir.c
@@ -192,11 +192,11 @@ static int setExtraSamples(TIFF *tif, va_list ap, uint32_t *v)
 static uint16_t countInkNamesString(TIFF *tif, uint32_t slen, const char *s)
 {
     uint16_t i = 0;
-    const char *ep = s + slen;
-    const char *cp = s;
 
     if (slen > 0)
     {
+        const char *ep = s + slen;
+        const char *cp = s;
         do
         {
             for (; cp < ep && *cp != '\0'; cp++)
