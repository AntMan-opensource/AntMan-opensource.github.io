commit 455b47d3756aed162d2d0ef7f40b549f3b5b30fe
Author: Joachim Nilsson <troglobit@gmail.com>
Date:   Sat Aug 31 10:08:29 2019 +0200

    FTP/TFTP: Fix directory traversal regression, reported by Aaron Esau
    
    Signed-off-by: Joachim Nilsson <troglobit@gmail.com>

diff --git a/src/common.c b/src/common.c
index 234d5ec..8e30772 100644
--- a/src/common.c
+++ b/src/common.c
@@ -92,7 +92,7 @@ check:
 		strlcat(rpath, name, sizeof(rpath));
 	}
 
-	if (!chrooted && strncmp(dir, home, strlen(home))) {
+	if (!chrooted && strncmp(rpath, home, strlen(home))) {
 		DBG("Failed non-chroot dir:%s vs home:%s", dir, home);
 		return NULL;
 	}
