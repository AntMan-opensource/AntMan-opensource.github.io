commit 626d10a94a88565d957ddc30768ed08b320049a7
Author: akallabeth <akallabeth@posteo.net>
Date:   Mon Apr 22 09:27:27 2024 +0200

    [core,redirection] fix length of redirection strings
    
    length field is in bytes, when converting from UCS-2 use size in WCHAR

diff --git a/libfreerdp/core/redirection.c b/libfreerdp/core/redirection.c
index 8538a9056..5343a071c 100644
--- a/libfreerdp/core/redirection.c
+++ b/libfreerdp/core/redirection.c
@@ -243,7 +243,7 @@ static BOOL rdp_redirection_read_base64_wchar(UINT32 flag, wStream* s, UINT32* p
 	const WCHAR* wchar = (const WCHAR*)ptr;
 
 	size_t utf8_len = 0;
-	char* utf8 = ConvertWCharNToUtf8Alloc(wchar, *pLength, &utf8_len);
+	char* utf8 = ConvertWCharNToUtf8Alloc(wchar, *pLength / sizeof(WCHAR), &utf8_len);
 	if (!utf8)
 		goto fail;
 
