commit 45acb4efbcaa57a20ac5127dc976538671fce018
Author: Dev Sanghani <devsanghani@gmail.com>
Date:   Wed Feb 10 13:09:54 2021 +0530

    [Core] Check Start/TLS cert

diff --git a/src/core/imap/MCIMAPSession.cpp b/src/core/imap/MCIMAPSession.cpp
index 734d74c8..38e73c20 100644
--- a/src/core/imap/MCIMAPSession.cpp
+++ b/src/core/imap/MCIMAPSession.cpp
@@ -682,6 +682,13 @@ void IMAPSession::connect(ErrorCode * pError)
             * pError = ErrorTLSNotAvailable;
             goto close;
         }
+            
+        mIsCertificateValid = checkCertificate();
+        if (isCheckCertificateEnabled() && !mIsCertificateValid) {
+            * pError = ErrorCertificate;
+            goto close;
+        }
+            
         break;
 
         case ConnectionTypeTLS:
