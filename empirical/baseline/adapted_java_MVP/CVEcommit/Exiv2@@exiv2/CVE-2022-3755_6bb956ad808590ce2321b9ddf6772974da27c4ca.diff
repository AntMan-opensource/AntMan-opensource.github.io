commit 6bb956ad808590ce2321b9ddf6772974da27c4ca
Author: Kevin Backhouse <kevinbackhouse@github.com>
Date:   Sat Oct 22 15:55:02 2022 +0100

    Credit to OSS-Fuzz: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=52382
    Avoid null pointer deref.

diff --git a/src/quicktimevideo.cpp b/src/quicktimevideo.cpp
index b3f41373e..011b3c296 100644
--- a/src/quicktimevideo.cpp
+++ b/src/quicktimevideo.cpp
@@ -834,6 +834,7 @@ void QuickTimeVideo::userDataDecoder(size_t size_external) {
     }
 
     else if (equalsQTimeTag(buf, "CMbo") || equalsQTimeTag(buf, "Cmbo")) {
+      enforce(tv, Exiv2::ErrorCode::kerCorruptedMetadata);
       io_->readOrThrow(buf.data(), 2);
       buf.data()[2] = '\0';
       tv_internal = find(cameraByteOrderTags, Exiv2::toString(buf.data()));
