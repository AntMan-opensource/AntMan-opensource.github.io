commit 14ec709a1ffae23ad777c37320290caa0a754341
Author: Aurelien David <aurelien.david@telecom-paristech.fr>
Date:   Tue Oct 17 16:59:25 2023 +0200

    swf_parse: check jpeg header size (fixes #2642)

diff --git a/src/scene_manager/swf_parse.c b/src/scene_manager/swf_parse.c
index 7816186e6..fd4fc60f9 100644
--- a/src/scene_manager/swf_parse.c
+++ b/src/scene_manager/swf_parse.c
@@ -2082,7 +2082,7 @@ static GF_Err swf_def_bits_jpeg(SWFReader *read, u32 version)
 	if (version!=3)
 		file = gf_fopen(szName, "wb");
 
-	if (version==1 && read->jpeg_hdr_size) {
+	if (version==1 && read->jpeg_hdr_size >= 2) {
 		/*remove JPEG EOI*/
 		if (gf_fwrite(read->jpeg_hdr, read->jpeg_hdr_size-2, file)!=read->jpeg_hdr_size-2)
 			return GF_IO_ERR;
