commit 2da2f68bffd51d89b1d272d22aa8cc023c1c066e
Author: jeanlf <jeanlf@gpac.io>
Date:   Fri Mar 12 11:46:56 2021 +0100

    fixed #1705

diff --git a/src/isomedia/stbl_read.c b/src/isomedia/stbl_read.c
index ebfbe62ab..384d4f782 100644
--- a/src/isomedia/stbl_read.c
+++ b/src/isomedia/stbl_read.c
@@ -419,11 +419,13 @@ GF_Err stbl_GetSampleInfos(GF_SampleTableBox *stbl, u32 sampleNumber, u64 *offse
 		if ( stbl->ChunkOffset->type == GF_ISOM_BOX_TYPE_STCO) {
 			stco = (GF_ChunkOffsetBox *)stbl->ChunkOffset;
 			if (!stco->offsets) return GF_ISOM_INVALID_FILE;
+			if (stco->nb_entries < sampleNumber) return GF_ISOM_INVALID_FILE;
 
 			(*offset) = (u64) stco->offsets[sampleNumber - 1];
 		} else {
 			co64 = (GF_ChunkLargeOffsetBox *)stbl->ChunkOffset;
 			if (!co64->offsets) return GF_ISOM_INVALID_FILE;
+			if (co64->nb_entries < sampleNumber) return GF_ISOM_INVALID_FILE;
 
 			(*offset) = co64->offsets[sampleNumber - 1];
 		}
