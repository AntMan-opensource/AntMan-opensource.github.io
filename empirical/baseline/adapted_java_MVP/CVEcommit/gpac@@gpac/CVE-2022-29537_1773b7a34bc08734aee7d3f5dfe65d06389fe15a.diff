commit 1773b7a34bc08734aee7d3f5dfe65d06389fe15a
Author: jeanlf <jeanlf@gpac.io>
Date:   Tue Apr 19 09:08:45 2022 +0200

    fixed #2173

diff --git a/src/ietf/rtp_pck_mpeg4.c b/src/ietf/rtp_pck_mpeg4.c
index d8bec0d20..462d2c99b 100644
--- a/src/ietf/rtp_pck_mpeg4.c
+++ b/src/ietf/rtp_pck_mpeg4.c
@@ -421,6 +421,7 @@ GF_Err gp_rtp_builder_do_avc(GP_RTPPacketizer *builder, u8 *nalu, u32 nalu_size,
 	}
 
 	if (!nalu) return GF_OK;
+	if (nalu_size<1) return GF_NON_COMPLIANT_BITSTREAM;
 
 	/*need a new RTP packet*/
 	if (!builder->bytesInPacket) {
@@ -559,6 +560,7 @@ GF_Err gp_rtp_builder_do_hevc(GP_RTPPacketizer *builder, u8 *nalu, u32 nalu_size
 	}
 
 	if (!nalu) return GF_OK;
+	if (nalu_size<2) return GF_NON_COMPLIANT_BITSTREAM;
 
 	/*need a new RTP packet*/
 	if (!builder->bytesInPacket) {
@@ -714,6 +716,7 @@ GF_Err gp_rtp_builder_do_vvc(GP_RTPPacketizer *builder, u8 *nalu, u32 nalu_size,
 	}
 
 	if (!nalu) return GF_OK;
+	if (nalu_size<2) return GF_NON_COMPLIANT_BITSTREAM;
 
 	/*need a new RTP packet*/
 	if (!builder->bytesInPacket) {
