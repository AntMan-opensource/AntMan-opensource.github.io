commit ac8bbdd5bb93c01679a881f5962fed800bf29e58
Author: Joseph Coffland <joseph@cauldrondevelopment.com>
Date:   Tue Apr 11 12:50:07 2023 +0300

    Path traversal bug in TarFileReader::extract() #115

diff --git a/src/cbang/tar/TarFileReader.cpp b/src/cbang/tar/TarFileReader.cpp
index 4e322fef..c9601f8f 100644
--- a/src/cbang/tar/TarFileReader.cpp
+++ b/src/cbang/tar/TarFileReader.cpp
@@ -101,7 +101,7 @@ std::string TarFileReader::extract(const string &_path) {
     // Check that path is under the target directory
     string a = SystemUtilities::getCanonicalPath(_path);
     string b = SystemUtilities::getCanonicalPath(path);
-    if (!String::startsWith(b, a))
+    if (!String::startsWith(b, a + "/"))
       THROW("Tar path points outside of the extraction directory: " << path);
   }
 
