commit ff3a5ebed6ffbe3e70481531cfb969b497aa73ad
Author: Yukihiro "Matz" Matsumoto <matz@ruby.or.jp>
Date:   Tue Feb 15 18:36:38 2022 +0900

    vm.c: should check type before hash access.
    
    Since the operand of double splat (`**`) may not be a hash, simple
    assertion (previous code since d42a64e) was not enough for this case.

diff --git a/src/vm.c b/src/vm.c
index 6133cbcca..9cb50847f 100644
--- a/src/vm.c
+++ b/src/vm.c
@@ -2766,7 +2766,7 @@ RETRY_TRY_BLOCK:
       int lim = a+b*2+1;
 
       hash = regs[a];
-      mrb_assert(mrb_hash_p(hash));
+      mrb_ensure_hash_type(mrb, hash);
       for (i=a+1; i<lim; i+=2) {
         mrb_hash_set(mrb, hash, regs[i], regs[i+1]);
       }
