commit 3cf291f72224715942beaf8553e42ba8891ab3c6
Author: Yukihiro "Matz" Matsumoto <matz@ruby.or.jp>
Date:   Mon Apr 4 12:26:52 2022 +0900

    vm.c: create break object before clearing GC arena.
    
    Otherwise it possibly cause use-after-free.

diff --git a/src/vm.c b/src/vm.c
index 3796f4173..6d61386b3 100644
--- a/src/vm.c
+++ b/src/vm.c
@@ -2268,9 +2268,9 @@ RETRY_TRY_BLOCK:
           }
           if (ci->cci > CINFO_NONE) {
             ci = cipop(mrb);
+            mrb->exc = (struct RObject*)break_new(mrb, RBREAK_TAG_BREAK, proc, v);
             mrb_gc_arena_restore(mrb, ai);
             mrb->c->vmexec = FALSE;
-            mrb->exc = (struct RObject*)break_new(mrb, RBREAK_TAG_BREAK, proc, v);
             mrb->jmp = prev_jmp;
             MRB_THROW(prev_jmp);
           }
