commit a868bacb46e3c900530bed47a1c6f85b0fbe701c
Author: Nicholas Marriott <nicholas.marriott@gmail.com>
Date:   Thu Oct 29 16:33:01 2020 +0000

    Do not write after the end of the array and overwrite the stack when
    colon-separated SGR sequences contain empty arguments. Reported by Sergey
    Nizovtsev.

diff --git a/input.c b/input.c
index 42a60c92..c280c0d9 100644
--- a/input.c
+++ b/input.c
@@ -1976,8 +1976,13 @@ input_csi_dispatch_sgr_colon(struct input_ctx *ictx, u_int i)
 				free(copy);
 				return;
 			}
-		} else
+		} else {
 			n++;
+			if (n == nitems(p)) {
+				free(copy);
+				return;
+			}
+		}
 		log_debug("%s: %u = %d", __func__, n - 1, p[n - 1]);
 	}
 	free(copy);
