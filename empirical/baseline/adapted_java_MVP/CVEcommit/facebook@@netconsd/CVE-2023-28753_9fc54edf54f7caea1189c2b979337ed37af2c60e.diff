commit 9fc54edf54f7caea1189c2b979337ed37af2c60e
Author: JP Kobryn <jpkobryn@meta.com>
Date:   Wed Mar 22 14:20:30 2023 -0700

    ensure fragment offset is less than total length
    
    Summary:
    when messages are received in fragments, we need to make sure the offset value is less than the length of all fragments to be received.
    
    CVE-2023-28753
    
    Reviewed By: kernelslacker
    
    Differential Revision: D44277643
    
    fbshipit-source-id: 8b4b163503a5574b05c0a185b615de61442a0309

diff --git a/ncrx/libncrx.c b/ncrx/libncrx.c
index e01ed41..5b9091c 100644
--- a/ncrx/libncrx.c
+++ b/ncrx/libncrx.c
@@ -257,6 +257,7 @@ static int parse_packet(const char *payload, struct ncrx_msg *msg)
 				goto einval;
 			if (!msg->text_len ||
 			    nf_len >= NCRX_LINE_MAX ||
+			    nf_off >= nf_len ||
 			    nf_off + msg->text_len > nf_len)
 				goto einval;
 
