commit b53a1583d05c3a5bfe5fa60da133fe59dfbb02b8
Author: pancake <pancake@nopcode.org>
Date:   Thu Dec 1 13:57:46 2022 +0100

    Fix integer overflow in fuzzed dwarf rendering in graphs ##crash
    
    * Reported by @solid-snail via huntrdev
    * BountyID: c6f8d3ef-5420-4eba-9a5f-aba5e2b5fea2/
    * Reproducer: `intof_mod`

diff --git a/dist/docker/Dockerfile b/dist/docker/Dockerfile
index af908b4aef..f1c4467bac 100644
--- a/dist/docker/Dockerfile
+++ b/dist/docker/Dockerfile
@@ -70,6 +70,9 @@ RUN DEBIAN_FRONTEND=noninteractive dpkg --add-architecture i386 && \
   bison \
   pkg-config \
   make \
+  python3 \
+  python3-pip \
+  sudo \
   glib-2.0 \
   libc6:i386 \
   libncurses5:i386 \
diff --git a/libr/core/canal.c b/libr/core/canal.c
index be6bd15326..d858cefdfb 100644
--- a/libr/core/canal.c
+++ b/libr/core/canal.c
@@ -1390,6 +1390,10 @@ static char *core_anal_graph_label(RCore *core, RAnalBlock *bb, int opts) {
 				filestr = r_file_slurp_line (file, line, 0);
 				if (filestr) {
 					int flen = strlen (filestr);
+					if (idx < 0 || ST32_ADD_OVFCHK (idx, flen + 8)) {
+						R_LOG_WARN ("integer overflow detected");
+						break;
+					}
 					cmdstr = realloc (cmdstr, idx + flen + 8);
 					memcpy (cmdstr + idx, filestr, flen);
 					idx += flen;
