commit 8419d7d0cbe61c687dcb8a35de0acccb2ee4c220
Author: Tronciu Vlad <105599724+TronciuVlad@users.noreply.github.com>
Date:   Sun Feb 11 11:58:58 2024 +0000

    Fixed null pointer dereference issue in treeblock

diff --git a/shlr/grub/fs/sfs.c b/shlr/grub/fs/sfs.c
index adc03e0754..0d20d08288 100644
--- a/shlr/grub/fs/sfs.c
+++ b/shlr/grub/fs/sfs.c
@@ -159,6 +159,9 @@ grub_sfs_read_extent (struct grub_sfs_data *data, unsigned int block,
     return 0;
 
   treeblock = grub_malloc (data->blocksize);
+  if(!treeblock){
+    return grub_error(GRUB_ERR_OUT_OF_MEMORY, "Failed to allocate memory for treeblock");
+  }
 
   next = grub_be_to_cpu32 (data->rblock.btree);
   tree = (struct grub_sfs_btree *) treeblock;
