commit a6d89de0d44e776f9bccc3a168fdc79f604e14ed
Author: ifyGecko <26214995+ifyGecko@users.noreply.github.com>
Date:   Wed Nov 30 04:34:45 2022 -0500

    ELF: added vn_next break condition (#3214)
    
    if the dynamic section's verneednum mismatches the true number of entries then the for loop in get_gnu_verneed will continue to iterate on the last entry since vn_next will be 0 on the last entry. If verneednum is set to all 0xff's it will take a very long time to finish this loop naturally drastically hindering binary load time. The solution is simple, to check for when vn_next == 0 and break out of the loop since all entries have been iterated over regardless of what verneednum indicates.

diff --git a/librz/bin/format/elf/elf_info.c b/librz/bin/format/elf/elf_info.c
index 8d22235a46..b5e002b610 100644
--- a/librz/bin/format/elf/elf_info.c
+++ b/librz/bin/format/elf/elf_info.c
@@ -1292,6 +1292,10 @@ static Sdb *get_gnu_verneed(ELFOBJ *bin) {
 
 		sdb_free(sdb_version);
 
+		if (!verneed_entry.vn_next) {
+			break;
+		}
+
 		verneed_offset += verneed_entry.vn_next;
 	}
 
