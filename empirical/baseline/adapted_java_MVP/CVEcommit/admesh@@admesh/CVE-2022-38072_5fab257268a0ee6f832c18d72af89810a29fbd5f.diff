commit 5fab257268a0ee6f832c18d72af89810a29fbd5f
Author: Anton Gladky <gladk@debian.org>
Date:   Fri Nov 18 23:04:28 2022 +0100

    Check the neighbor_index in stl_check_normal_vector
    
    
    Fixes #60

diff --git a/src/normals.c b/src/normals.c
index 2832899..91f1fd2 100644
--- a/src/normals.c
+++ b/src/normals.c
@@ -142,7 +142,8 @@ stl_fix_normal_directions(stl_file *stl) {
         }
       }
       /* If this edge of the facet is connected: */
-      if(stl->neighbors_start[facet_num].neighbor[j] != -1) {
+      if(stl->neighbors_start[facet_num].neighbor[j] != -1 &&
+         stl->neighbors_start[facet_num].neighbor[j] < stl->stats.number_of_facets*sizeof(char)) {
         /* If we haven't fixed this facet yet, add it to the list: */
         if(norm_sw[stl->neighbors_start[facet_num].neighbor[j]] != 1) {
           /* Add node to beginning of list. */
