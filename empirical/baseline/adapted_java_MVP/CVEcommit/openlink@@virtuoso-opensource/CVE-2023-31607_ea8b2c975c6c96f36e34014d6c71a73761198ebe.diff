commit ea8b2c975c6c96f36e34014d6c71a73761198ebe
Author: Mitko Iliev <imitko@openlinksw.com>
Date:   Thu Apr 13 14:08:01 2023 +0200

    Fixed missing check for max number of key parts (fixes #1120)

diff --git a/libsrc/Wi/ddlrun.c b/libsrc/Wi/ddlrun.c
index 78c37c1d9..fff421d05 100644
--- a/libsrc/Wi/ddlrun.c
+++ b/libsrc/Wi/ddlrun.c
@@ -1354,6 +1354,8 @@ ddl_create_key (query_instance_t * qi,
   char *szTheTableName;
   dk_set_t to_free = NULL;
 
+  if (n_parts > K_MAX_PARTS)
+    sqlr_new_error ("42S12", "SQ017", "Too many key parts");
   memcpy (parts_tmp, parts, box_length ((caddr_t) parts));
 
   qr_rec_exec (find_primary_stmt, cli, &lc_keys, qi, NULL, 1,
