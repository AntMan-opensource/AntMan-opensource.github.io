commit 6df21ff8de361e7a9beb7cfd09945378b00b90e2
Author: Xiaochen Wang <wangxiaochen0@gmail.com>
Date:   Wed Mar 19 15:13:12 2014 +0800

    SPDY: memory corruption (bugfix for CVE-2014-0088)
    
    More details from nginx announcement are available here:
     http://mailman.nginx.org/pipermail/nginx-announce/2014/000132.html

diff --git a/src/http/ngx_http_spdy.c b/src/http/ngx_http_spdy.c
index c6a3e41c..9c5bde10 100644
--- a/src/http/ngx_http_spdy.c
+++ b/src/http/ngx_http_spdy.c
@@ -878,7 +878,7 @@ ngx_http_spdy_state_headers(ngx_http_spdy_connection_t *sc, u_char *pos,
         ngx_log_debug1(NGX_LOG_DEBUG_HTTP, r->connection->log, 0,
                        "spdy headers count: %ui", sc->headers);
 
-        if (ngx_list_init(&r->headers_in.headers, r->pool, sc->headers + 3,
+        if (ngx_list_init(&r->headers_in.headers, r->pool, 20,
                           sizeof(ngx_table_elt_t))
             != NGX_OK)
         {
diff --git a/src/http/ngx_http_spdy_v3.c b/src/http/ngx_http_spdy_v3.c
index 0a3a5b6c..7b7e366d 100644
--- a/src/http/ngx_http_spdy_v3.c
+++ b/src/http/ngx_http_spdy_v3.c
@@ -1045,7 +1045,7 @@ ngx_http_spdy_state_headers(ngx_http_spdy_connection_t *sc, u_char *pos,
         ngx_log_debug1(NGX_LOG_DEBUG_HTTP, r->connection->log, 0,
                        "spdy headers count: %ui", sc->headers);
 
-        if (ngx_list_init(&r->headers_in.headers, r->pool, sc->headers + 3,
+        if (ngx_list_init(&r->headers_in.headers, r->pool, 20,
                           sizeof(ngx_table_elt_t))
             != NGX_OK)
         {
