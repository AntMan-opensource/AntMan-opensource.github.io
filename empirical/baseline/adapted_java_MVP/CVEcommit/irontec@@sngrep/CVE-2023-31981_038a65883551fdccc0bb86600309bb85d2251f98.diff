commit 038a65883551fdccc0bb86600309bb85d2251f98
Author: Kaian <kaian@irontec.com>
Date:   Wed Mar 1 12:55:10 2023 +0100

    capture: properly validate capture length calculated from IP headers #430

diff --git a/src/capture.c b/src/capture.c
index 825ee12..0057063 100644
--- a/src/capture.c
+++ b/src/capture.c
@@ -616,6 +616,10 @@ capture_packet_reasm_ip(capture_info_t *capinfo, const struct pcap_pkthdr *heade
         }
     }
 
+    // Check maximum capture len
+    if (*caplen > MAX_CAPTURE_LEN)
+        return NULL;
+
     // If no fragmentation
     if (ip_frag == 0) {
         // Just create a new packet with given network data
