commit 083f5ffdee661f61512909d16f9a5b98cff3cf0b
Author: Wilfred Hughes <wilfred@fb.com>
Date:   Fri Jan 13 15:54:56 2023 -0800

    [security] Disable TLS 1.0 in stream extension URLs
    
    The stream extension has the functions `stream_socket_server` and
    `stream_socket_client` which accept URLs. When a URL starts with
    `tls://` it would previously allow TLS 1.0 connections.
    
    TLS 1.0 is deprecated and considered insecure.

diff --git a/hphp/runtime/base/ssl-socket.cpp b/hphp/runtime/base/ssl-socket.cpp
index c08564bba3a..6b533eccc94 100644
--- a/hphp/runtime/base/ssl-socket.cpp
+++ b/hphp/runtime/base/ssl-socket.cpp
@@ -499,7 +499,7 @@ bool SSLSocket::setupCrypto(SSLSocket *session /* = NULL */) {
     break;
   case CryptoMethod::ClientTLS:
     m_data->m_client = true;
-    smethod = TLSv1_client_method();
+    smethod = TLS_client_method();
     break;
   case CryptoMethod::ServerSSLv23:
     m_data->m_client = false;
@@ -542,7 +542,7 @@ bool SSLSocket::setupCrypto(SSLSocket *session /* = NULL */) {
 
   case CryptoMethod::ServerTLS:
     m_data->m_client = false;
-    smethod = TLSv1_server_method();
+    smethod = TLS_server_method();
     break;
   default:
     return false;
