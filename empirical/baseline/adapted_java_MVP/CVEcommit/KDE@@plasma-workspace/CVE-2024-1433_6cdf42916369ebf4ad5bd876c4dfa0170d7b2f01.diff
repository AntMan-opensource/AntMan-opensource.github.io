commit 6cdf42916369ebf4ad5bd876c4dfa0170d7b2f01
Author: Benjamin Flesch <benjaminflesch@icloud.com>
Date:   Sat Feb 3 10:24:23 2024 +0000

    plasmacalendarintegration: Fix directory traversal vulnerability in events plugins
    
    digital-calendar plasma applet is vulnerable to directory traversal attack which allows an arbitrary .so library file to be leaded as a plasma calendar plugin.
    
    This vulnerability can be triggered via theme files that provide a config for the digital-clock applet which includes `enabledCalendarPlugins` that uses directory traversal to load arbitrary .so from the filesystem.
    
    This requires write access to user's home or the installation of third party global themes so is not directly exploitable by anything which did not have access already, however it should be fixed regardless.

diff --git a/components/calendar/eventpluginsmanager.cpp b/components/calendar/eventpluginsmanager.cpp
index 63a2c44608..a982c18a20 100644
--- a/components/calendar/eventpluginsmanager.cpp
+++ b/components/calendar/eventpluginsmanager.cpp
@@ -201,7 +201,7 @@ QStringList EventPluginsManager::enabledPlugins() const
 
 void EventPluginsManager::loadPlugin(const QString &pluginId)
 {
-    QPluginLoader loader("plasmacalendarplugins/" + pluginId);
+    QPluginLoader loader("plasmacalendarplugins/" + QDir::cleanPath(pluginId));
 
     if (!loader.load()) {
         qWarning() << "Could not create Plasma Calendar Plugin: " << pluginId;
