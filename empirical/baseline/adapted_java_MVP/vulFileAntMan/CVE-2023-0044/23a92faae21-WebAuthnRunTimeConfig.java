package io.quarkus.security.webauthn;
import java.time.Duration;
import java.util.List;
import java.util.Optional;
import java.util.OptionalInt;
import io.quarkus.runtime.annotations.ConfigGroup;
import io.quarkus.runtime.annotations.ConfigItem;
import io.quarkus.runtime.annotations.ConfigPhase;
import io.quarkus.runtime.annotations.ConfigRoot;
import io.quarkus.vertx.http.runtime.FormAuthConfig.CookieSameSite;
import io.vertx.ext.auth.webauthn.Attestation;
import io.vertx.ext.auth.webauthn.AuthenticatorAttachment;
import io.vertx.ext.auth.webauthn.AuthenticatorTransport;
import io.vertx.ext.auth.webauthn.PublicKeyCredential;
import io.vertx.ext.auth.webauthn.UserVerification;
@ConfigRoot(name = "webauthn", phase = ConfigPhase.RUN_TIME)
public class WebAuthnRunTimeConfig {
    public enum CookieSameSite {
        STRICT, LAX, NONE }
    public Optional<String> origin;
    @ConfigItem(defaultValueDocumentation = "USB,NFC,BLE,INTERNAL")
    public Optional<List<AuthenticatorTransport>> transports;
    public RelyingPartyConfig relyingParty;
    public Optional<AuthenticatorAttachment> authenticatorAttachment;
    @ConfigItem(defaultValueDocumentation = "false")
    public Optional<Boolean> requireResidentKey;
    @ConfigItem(defaultValueDocumentation = "REQUIRED")
    public Optional<UserVerification> userVerification;
    @ConfigItem(defaultValueDocumentation = "60s")
    public Optional<Duration> timeout;
    @ConfigItem(defaultValueDocumentation = "NONE")
    public Optional<Attestation> attestation;
    @ConfigItem(defaultValueDocumentation = "ES256,RS256")
    public Optional<List<PublicKeyCredential>> pubKeyCredParams;
    @ConfigItem(defaultValueDocumentation = "64")
    public OptionalInt challengeLength;
    public static class RelyingPartyConfig {
        public Optional<String> id;
        @ConfigItem(defaultValue = "Quarkus server")
        public String name;
    }
    
    @ConfigItem(defaultValue = "/login.html")
    public String loginPage;
    @ConfigItem(defaultValue = "PT30M")
    public Duration sessionTimeout;
    @ConfigItem(defaultValue = "PT1M")
    public Duration newCookieInterval;
    @ConfigItem(defaultValue = "quarkus-credential")
    public String cookieName;
    @ConfigItem(defaultValue = "strict")
    public CookieSameSite cookieSameSite = CookieSameSite.STRICT;
}


