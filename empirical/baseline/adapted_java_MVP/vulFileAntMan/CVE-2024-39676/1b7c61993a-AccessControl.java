package org.apache.pinot.controller.api.access;
import javax.annotation.Nullable;
import javax.ws.rs.core.HttpHeaders;
import org.apache.pinot.spi.annotations.InterfaceAudience;
import org.apache.pinot.spi.annotations.InterfaceStability;
public interface AccessControl {
  String WORKFLOW_NONE = "NONE";
  String WORKFLOW_BASIC = "BASIC";
  @Deprecated
  default boolean hasDataAccess(HttpHeaders httpHeaders, String tableName) {
    return hasAccess(tableName, AccessType.READ, httpHeaders, null);
  }
  
  default boolean hasAccess(@Nullable String tableName, AccessType accessType, HttpHeaders httpHeaders, @Nullable String endpointUrl) {
    return true;
  }
  
  default boolean hasAccess(AccessType accessType, HttpHeaders httpHeaders, @Nullable String endpointUrl) {
    return hasAccess(null, accessType, httpHeaders, endpointUrl);
  }
  
  default boolean protectAnnotatedOnly() {
    return true;
  }
  
  default AuthWorkflowInfo getAuthWorkflowInfo() {
    return new AuthWorkflowInfo(WORKFLOW_NONE);
  }
  
  class AuthWorkflowInfo {
    String _workflow;
    public AuthWorkflowInfo(String workflow) {
      _workflow = workflow;
    }
    
    public String getWorkflow() {
      return _workflow;
    }
    
    public void setWorkflow(String workflow) {
      _workflow = workflow;
    }
    
  }
  
}


