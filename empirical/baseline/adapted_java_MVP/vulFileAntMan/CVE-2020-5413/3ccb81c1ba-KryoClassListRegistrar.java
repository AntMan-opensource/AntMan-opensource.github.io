package org.springframework.integration.codec.kryo;
import java.util.ArrayList;
import java.util.List;
import org.springframework.util.Assert;
import org.springframework.util.CollectionUtils;
import com.esotericsoftware.kryo.Registration;
public class KryoClassListRegistrar extends AbstractKryoRegistrar {
	private static final int DEFAULT_INITIAL_ID = 50;
	private final List<Class<?>> registeredClasses;
	private int initialValue = DEFAULT_INITIAL_ID;
	 public KryoClassListRegistrar(List<Class<?>> classes) {
		this.registeredClasses = new ArrayList<>(classes);
	}
	
	 public void setInitialValue(int initialValue) {
		Assert.isTrue(initialValue >= MIN_REGISTRATION_VALUE, "'initialValue' must be >= " + MIN_REGISTRATION_VALUE);
		this.initialValue = initialValue;
	}
	
	public List<Registration> getRegistrations() {
		List<Registration> registrations = new ArrayList<>();
		if (!CollectionUtils.isEmpty(this.registeredClasses)) {
			for (int i = 0; i < this.registeredClasses.size(); i++) {
				registrations.add(new Registration(this.registeredClasses.get(i), KRYO.getSerializer(this.registeredClasses.get(i)), i + this.initialValue));
			}
			
		}
		
		return registrations;
	}
	
}


