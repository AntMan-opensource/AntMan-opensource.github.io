package org.apache.hadoop.hdds.security.token;
import org.apache.hadoop.hdds.HddsUtils;
import org.apache.hadoop.hdds.protocol.datanode.proto.ContainerProtos;
import org.apache.hadoop.hdds.protocol.datanode.proto.ContainerProtos.ContainerCommandRequestProto;
import org.apache.hadoop.hdds.scm.container.ContainerID;
import org.apache.hadoop.hdds.security.x509.SecurityConfig;
import org.apache.hadoop.hdds.security.x509.certificate.client.CertificateClient;
public class ContainerTokenVerifier extends ShortLivedTokenVerifier<ContainerTokenIdentifier> {
  public ContainerTokenVerifier(SecurityConfig conf, CertificateClient caClient) {
    super(conf, caClient);
  }
  
  protected boolean isTokenRequired(ContainerProtos.Type cmdType) {
    return getConf().isContainerTokenEnabled() && HddsUtils.requireContainerToken(cmdType);
  }
  
  protected ContainerTokenIdentifier createTokenIdentifier() {
    return new ContainerTokenIdentifier();
  }
  
  protected Object getService(ContainerCommandRequestProto cmd) {
    return ContainerID.valueOf(cmd.getContainerID());
  }
  
}


