package org.apache.hadoop.hdds.security.token;
import org.apache.hadoop.hdds.protocol.datanode.proto.ContainerProtos.ContainerCommandRequestProto;
import org.apache.hadoop.hdds.security.exception.SCMSecurityException;
import org.apache.hadoop.security.token.Token;
import java.util.LinkedList;
import java.util.List;
public class CompositeTokenVerifier implements TokenVerifier {
  private final List<TokenVerifier> delegates = new LinkedList<>();
  public CompositeTokenVerifier(List<TokenVerifier> delegates) {
    this.delegates.addAll(delegates);
  }
  
  public void verify(String user, Token<?> token, ContainerCommandRequestProto cmd) throws SCMSecurityException {
    for (TokenVerifier verifier : delegates) {
      verifier.verify(user, token, cmd);
    }
    
  }
  
}


