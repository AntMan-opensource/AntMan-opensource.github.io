commit 33b1951f153c3c5dc8ed736b9110437e1a619b7d
Author: Kamila Szewczyk <kspalaiologos@gmail.com>
Date:   Wed Mar 22 14:37:32 2023 +0100

    strict check for size_src overflow of badly bounded b1

diff --git a/src/libbz3.c b/src/libbz3.c
index be896e2..31e11bf 100644
--- a/src/libbz3.c
+++ b/src/libbz3.c
@@ -710,7 +710,7 @@ BZIP3_API s32 bz3_decode_block(struct bz3_state * state, u8 * buffer, s32 data_s
 
     state->last_error = BZ3_OK;
 
-    if (size_src > bz3_bound(state->block_size) || size_src < 0) {
+    if (size_src > state->block_size || size_src < 0) {
         state->last_error = BZ3_ERR_MALFORMED_HEADER;
         return -1;
     }
