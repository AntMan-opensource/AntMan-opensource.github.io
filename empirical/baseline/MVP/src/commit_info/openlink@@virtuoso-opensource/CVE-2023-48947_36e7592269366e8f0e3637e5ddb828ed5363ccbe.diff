commit 36e7592269366e8f0e3637e5ddb828ed5363ccbe
Author: Mitko Iliev <imitko@openlinksw.com>
Date:   Thu Nov 16 17:40:00 2023 +0200

    Fixed issue with chash (fixes #1179)
    
    chash does not work on union where branche has const, use memhash instead

diff --git a/libsrc/Wi/chash.c b/libsrc/Wi/chash.c
index 64a2798a2..2ea294027 100644
--- a/libsrc/Wi/chash.c
+++ b/libsrc/Wi/chash.c
@@ -2279,6 +2279,8 @@ setp_chash_distinct (setp_node_t * setp, caddr_t * inst)
       if (!cha)
 	return 0;
     }
+  if (cha && cha->cha_n_keys != ha->ha_n_keys)
+    goto no;
   if (cha && cha->cha_oversized)
     goto no;
   if (ha->ha_n_keys >= CHASH_GB_MAX_KEYS)
