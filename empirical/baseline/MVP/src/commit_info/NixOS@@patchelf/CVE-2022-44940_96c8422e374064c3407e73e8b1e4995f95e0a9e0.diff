commit 96c8422e374064c3407e73e8b1e4995f95e0a9e0
Author: zhailiangliang <zhailiangliang@loongson.cn>
Date:   Wed Oct 26 10:48:04 2022 +0800

    Out-of-bounds read exists in the function modifyRPath

diff --git a/src/patchelf.cc b/src/patchelf.cc
index 505c980..790689c 100644
--- a/src/patchelf.cc
+++ b/src/patchelf.cc
@@ -1371,6 +1371,7 @@ void ElfFile<ElfFileParamNames>::modifyRPath(RPathOp op,
        string. */
     std::vector<std::string> neededLibs;
     auto dyn = (Elf_Dyn *)(fileContents->data() + rdi(shdrDynamic.sh_offset));
+    checkPointer(fileContents, dyn, sizeof(*dyn));
     Elf_Dyn *dynRPath = nullptr, *dynRunPath = nullptr;
     char * rpath = nullptr;
     for ( ; rdi(dyn->d_tag) != DT_NULL; dyn++) {
