commit 32748c69b898aa387687abafd6b30702696ac15b
Author: Jukka Rissanen <jukka.rissanen@nordicsemi.no>
Date:   Tue Dec 19 12:31:37 2023 +0200

    net: ipv4: Drop packet if source address is my address
    
    If we receive a packet where the source address is our own
    address, then we should drop it.
    
    Signed-off-by: Jukka Rissanen <jukka.rissanen@nordicsemi.no>
    (cherry picked from commit 19392a6d2b5eee26ba62fcc6f61e769b4cebaa32)

diff --git a/subsys/net/ip/ipv4.c b/subsys/net/ip/ipv4.c
index c400878991f..bbc5366a904 100644
--- a/subsys/net/ip/ipv4.c
+++ b/subsys/net/ip/ipv4.c
@@ -272,6 +272,11 @@ enum net_verdict net_ipv4_input(struct net_pkt *pkt, bool is_loopback)
 			NET_DBG("DROP: localhost packet");
 			goto drop;
 		}
+
+		if (net_ipv4_is_my_addr(&hdr->src)) {
+			NET_DBG("DROP: src addr is %s", "mine");
+			goto drop;
+		}
 	}
 
 	if (net_ipv4_is_addr_mcast(&hdr->src)) {
