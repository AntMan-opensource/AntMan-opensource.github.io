commit 10ef3b46d870f9672bb6407d78bf94a6e3fb9675
Author: Aleksandr Khromykh <aleksandr.khromykh@nordicsemi.no>
Date:   Wed Jun 21 10:48:10 2023 +0200

    Bluetooth: Mesh: fix provisionee public key usage
    
    Provisionee shall fail if provisioner sent public key
    identicall to OOB public key back.
    
    Signed-off-by: Aleksandr Khromykh <aleksandr.khromykh@nordicsemi.no>

diff --git a/subsys/bluetooth/mesh/prov_device.c b/subsys/bluetooth/mesh/prov_device.c
index deceae58ad0..48d852cb1a7 100644
--- a/subsys/bluetooth/mesh/prov_device.c
+++ b/subsys/bluetooth/mesh/prov_device.c
@@ -357,6 +357,13 @@ static void prov_pub_key(const uint8_t *data)
 			return;
 		}
 
+		if (!memcmp(bt_mesh_prov->public_key_be,
+			    bt_mesh_prov_link.conf_inputs.pub_key_provisioner, PDU_LEN_PUB_KEY)) {
+			LOG_ERR("Public keys are identical");
+			prov_fail(PROV_ERR_NVAL_FMT);
+			return;
+		}
+
 		/* No swap needed since user provides public key in big-endian */
 		memcpy(bt_mesh_prov_link.conf_inputs.pub_key_device, bt_mesh_prov->public_key_be,
 		       PDU_LEN_PUB_KEY);
