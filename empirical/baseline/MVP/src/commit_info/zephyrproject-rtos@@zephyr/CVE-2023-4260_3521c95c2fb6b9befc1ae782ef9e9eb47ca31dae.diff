commit 3521c95c2fb6b9befc1ae782ef9e9eb47ca31dae
Author: Flavio Ceolin <flavio.ceolin@intel.com>
Date:   Mon Sep 25 23:19:13 2023 -0700

    fs: fuse: Fix possible buffer overflow
    
    Ensure that the path in fuse_fs_access_readdir does not overflow
    the local buffer.
    
    Signed-off-by: Flavio Ceolin <flavio.ceolin@intel.com>

diff --git a/subsys/fs/fuse_fs_access.c b/subsys/fs/fuse_fs_access.c
index 8453c6544e8..11e8f0225d9 100644
--- a/subsys/fs/fuse_fs_access.c
+++ b/subsys/fs/fuse_fs_access.c
@@ -176,9 +176,15 @@ static int fuse_fs_access_readdir(const char *path, void *buf,
 		 * directory but FUSE strips the trailing slashes from
 		 * directory names so add it back.
 		 */
-		char mount_path[PATH_MAX];
+		char mount_path[PATH_MAX] = {0};
+		size_t len = strlen(path);
 
-		sprintf(mount_path, "%s/", path);
+		if (len >= (PATH_MAX - 2)) {
+			return -ENOMEM;
+		}
+
+		memcpy(mount_path, path, len)
+		mount_path[len] = '/';
 		err = fs_opendir(&dir, mount_path);
 	} else {
 		err = fs_opendir(&dir, path);
