commit 8977784afee870e107f639ace7a4b5cd57cfaeb6
Author: Flavio Ceolin <flavio.ceolin@intel.com>
Date:   Tue Dec 12 10:20:45 2023 -0800

    settings: shell: Fix possible buffer overflow
    
    Checks the size of the given string before copying it to internal
    buffer.
    
    Signed-off-by: Flavio Ceolin <flavio.ceolin@intel.com>

diff --git a/subsys/settings/src/settings_shell.c b/subsys/settings/src/settings_shell.c
index e8132eeeb49..bef6b23c2b5 100644
--- a/subsys/settings/src/settings_shell.c
+++ b/subsys/settings/src/settings_shell.c
@@ -182,6 +182,11 @@ static int cmd_write(const struct shell *shell_ptr, size_t argc, char *argv[])
 		break;
 	case SETTINGS_VALUE_STRING:
 		buffer_len = strlen(argv[argc - 1]) + 1;
+		if (buffer_len > sizeof(buffer)) {
+			shell_error(shell_ptr, "%s is bigger than shell's buffer", argv[argc - 1]);
+			return -EINVAL;
+		}
+
 		memcpy(buffer, argv[argc - 1], buffer_len);
 		break;
 	}
