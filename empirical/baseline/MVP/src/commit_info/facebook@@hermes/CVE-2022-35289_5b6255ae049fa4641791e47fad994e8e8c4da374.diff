commit 5b6255ae049fa4641791e47fad994e8e8c4da374
Author: Facebook Community Bot <facebook-github-bot@users.noreply.github.com>
Date:   Tue Aug 2 13:52:30 2022 -0700

    Re-sync with internal repository (#791)
    
    Co-authored-by: Facebook Community Bot <6422482+facebook-github-bot@users.noreply.github.com>

diff --git a/lib/VM/detail/IdentifierHashTable.cpp b/lib/VM/detail/IdentifierHashTable.cpp
index bf4dc6469..7cfbb1985 100644
--- a/lib/VM/detail/IdentifierHashTable.cpp
+++ b/lib/VM/detail/IdentifierHashTable.cpp
@@ -138,6 +138,10 @@ void IdentifierHashTable::remove(const StringPrimitive *str) {
 }
 
 void IdentifierHashTable::growAndRehash(uint32_t newCapacity) {
+  // Guard against potential overflow in the calculation of new capacity.
+  if (LLVM_UNLIKELY(newCapacity <= capacity())) {
+    hermes_fatal("too many identifiers created");
+  }
   assert(llvh::isPowerOf2_32(newCapacity) && "capacity must be power of 2");
   CompactTable tmpTable(newCapacity, table_.getCurrentScale());
   tmpTable.swap(table_);
