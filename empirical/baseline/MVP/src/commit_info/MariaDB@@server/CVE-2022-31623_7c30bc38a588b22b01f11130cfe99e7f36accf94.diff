commit 7c30bc38a588b22b01f11130cfe99e7f36accf94
Author: Daniel Black <daniel@mariadb.org>
Date:   Wed Oct 27 09:42:45 2021 +1100

    MDEV-26561 mariabackup release locks
    
    The previous threads locked need to be released too.
    
    This occurs if the initialization of any of the non-first
    mutex/conditition variables errors occurs.

diff --git a/extra/mariabackup/ds_compress.cc b/extra/mariabackup/ds_compress.cc
index 72c93879947..a85523bd880 100644
--- a/extra/mariabackup/ds_compress.cc
+++ b/extra/mariabackup/ds_compress.cc
@@ -386,6 +386,13 @@ create_worker_threads(uint n)
 	return threads;
 
 err:
+	while (i > 0) {
+		comp_thread_ctxt_t *thd;
+		i--;
+		thd = threads + i;
+		pthread_mutex_unlock(&thd->ctrl_mutex);
+	}
+
 	my_free(threads);
 	return NULL;
 }
