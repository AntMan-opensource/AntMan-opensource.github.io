commit 5c14bf53fb42ceca12bbcc0016e8704b1580920d
Author: Michael Onken <onken@open-connections.de>
Date:   Wed Sep 15 09:04:12 2021 +0200

    Fixed possible NULL pointer dereference.
    
    Thanks to Jinsheng Ba <bajinsheng@u.nus.edu> for the report and patch.

diff --git a/dcmnet/libsrc/diutil.cc b/dcmnet/libsrc/diutil.cc
index 45d486e39..0a6f05ae4 100644
--- a/dcmnet/libsrc/diutil.cc
+++ b/dcmnet/libsrc/diutil.cc
@@ -171,7 +171,8 @@ DU_getStringDOElement(DcmItem *obj, DcmTagKey t, char *s, size_t bufsize)
             s[0] = '\0';
         } else {
             ec =  elem->getString(aString);
-            OFStandard::strlcpy(s, aString, bufsize);
+            if (ec == EC_Normal)
+                OFStandard::strlcpy(s, aString, bufsize);
         }
     }
     return (ec == EC_Normal);
