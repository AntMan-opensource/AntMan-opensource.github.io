commit bfb6de155f9fb015d2904cb4ef07809f17995276
Author: Dirk Farin <dirk.farin@gmail.com>
Date:   Sun Jan 29 12:20:48 2023 +0100

    fix for monochrome MC (fixes #381)

diff --git a/libde265/motion.cc b/libde265/motion.cc
index 37ca68fa..38f768d5 100644
--- a/libde265/motion.cc
+++ b/libde265/motion.cc
@@ -543,12 +543,14 @@ void generate_inter_prediction_samples(base_context* ctx,
         int16_t* in10 = predSamplesC[1][0];
         int16_t* in11 = predSamplesC[1][1];
 
-        ctx->acceleration.put_weighted_pred_avg(pixels[1], stride[1],
-                                                in00,in01, nCS,
-                                                nPbW/SubWidthC, nPbH/SubHeightC, bit_depth_C);
-        ctx->acceleration.put_weighted_pred_avg(pixels[2], stride[2],
-                                                in10,in11, nCS,
-                                                nPbW/SubWidthC, nPbH/SubHeightC, bit_depth_C);
+        if (img->get_chroma_format() != de265_chroma_mono) {
+          ctx->acceleration.put_weighted_pred_avg(pixels[1], stride[1],
+                                                  in00, in01, nCS,
+                                                  nPbW / SubWidthC, nPbH / SubHeightC, bit_depth_C);
+          ctx->acceleration.put_weighted_pred_avg(pixels[2], stride[2],
+                                                  in10, in11, nCS,
+                                                  nPbW / SubWidthC, nPbH / SubHeightC, bit_depth_C);
+        }
       }
       else {
         // weighted prediction
