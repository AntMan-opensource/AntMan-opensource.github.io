commit 508a6307045441defd1bef0999a1f7052097613f
Author: echel0n <melih.sahin@protonmail.com>
Date:   Tue Mar 21 20:52:41 2023 +0300

    fix segfault when bin->symbols is NULL #21503

diff --git a/libr/bin/p/bin_coff.c b/libr/bin/p/bin_coff.c
index caecf55a53..deeb7c7e9b 100644
--- a/libr/bin/p/bin_coff.c
+++ b/libr/bin/p/bin_coff.c
@@ -505,11 +505,13 @@ static RList *patch_relocs(RBin *b) {
 
 	size_t nimports = 0;
 	int i;
-	for (i = 0; i < bin->hdr.f_nsyms; i++) {
-		if (is_imported_symbol (&bin->symbols[i])) {
-			nimports++;
+	if (bin->symbols) {
+		for (i = 0; i < bin->hdr.f_nsyms; i++) {
+			if (is_imported_symbol (&bin->symbols[i])) {
+				nimports++;
+			}
+			i += bin->symbols[i].n_numaux;
 		}
-		i += bin->symbols[i].n_numaux;
 	}
 	ut64 m_vaddr = UT64_MAX;
 	if (nimports) {
