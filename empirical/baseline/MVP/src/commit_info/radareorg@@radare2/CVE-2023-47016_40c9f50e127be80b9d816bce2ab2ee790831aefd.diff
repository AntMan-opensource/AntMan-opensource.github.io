commit 40c9f50e127be80b9d816bce2ab2ee790831aefd
Author: pancake <pancake@nopcode.org>
Date:   Sat Oct 28 19:02:07 2023 +0200

    Fix #22349 - oobread in xnu kernelcache ##crash
    
    * Reproducer rabin_hbo_194
    * Reported by @gandalf4a

diff --git a/libr/bin/p/bin_xnu_kernelcache.c b/libr/bin/p/bin_xnu_kernelcache.c
index b3da18139f..19da1a203e 100644
--- a/libr/bin/p/bin_xnu_kernelcache.c
+++ b/libr/bin/p/bin_xnu_kernelcache.c
@@ -988,7 +988,7 @@ static void process_constructors(RKernelCacheObj *obj, struct MACH0_(obj_t) *mac
 		}
 		int j;
 		int count = 0;
-		for (j = 0; j < section->size; j += 8) {
+		for (j = 0; j + 7 < section->size; j += 8) {
 			ut64 addr64 = K_RPTR (buf + j);
 			ut64 paddr64 = section->paddr + paddr + j;
 			if (mode == R_K_CONSTRUCTOR_TO_ENTRY) {
