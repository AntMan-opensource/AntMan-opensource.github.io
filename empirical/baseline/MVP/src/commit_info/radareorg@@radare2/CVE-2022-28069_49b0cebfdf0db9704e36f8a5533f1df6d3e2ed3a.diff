commit 49b0cebfdf0db9704e36f8a5533f1df6d3e2ed3a
Author: Sergi Ã€lvarez i Capilla <pancake@nowsecure.com>
Date:   Sat Oct 30 00:03:22 2021 +0200

    Fix oobread in VAX disassembler (tests_64920) ##crash
    
    Reported by giantbranch of NSFOCUS TIANJI Lab

diff --git a/libr/anal/p/anal_vax.c b/libr/anal/p/anal_vax.c
index 93169b1848..3e6e47d941 100644
--- a/libr/anal/p/anal_vax.c
+++ b/libr/anal/p/anal_vax.c
@@ -150,7 +150,7 @@ static int vax_op(RAnal *anal, RAnalOp *op, ut64 addr, const ut8 *buf, int len,
 	case 0xfb: // calls
 		op->type = R_ANAL_OP_TYPE_CALL;
 		op->size = 7;
-		{
+		if (len > 6) {
 			int oa = 3;
 			ut32 delta = buf[oa];
 			delta |= (ut32)(buf[oa + 1]) << 8;
