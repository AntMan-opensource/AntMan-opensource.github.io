commit db74835944548fc3bdf03121b0e012373bdebb3e
Author: Aurelien David <aurelien.david@telecom-paristech.fr>
Date:   Mon Oct 23 13:02:56 2023 +0200

    reframe_mpgvid: add size check (fixes #2651)

diff --git a/src/filters/reframe_mpgvid.c b/src/filters/reframe_mpgvid.c
index 8e092f973..ecf251955 100644
--- a/src/filters/reframe_mpgvid.c
+++ b/src/filters/reframe_mpgvid.c
@@ -1081,6 +1081,11 @@ GF_Err mpgviddmx_process(GF_Filter *filter)
 		//needs adjustement
 		if (bytes_from_store) {
 			size += bytes_from_store + hdr_offset;
+			if (size > remain) {
+				e = GF_NON_COMPLIANT_BITSTREAM;
+				GF_LOG(GF_LOG_ERROR, GF_LOG_MEDIA, ("[MPGVid] packet too large to process (size %llu remain %d)\n", size, remain ));
+				break;
+			}
 		}
 
 		if ((e == GF_EOS) && !ctx->input_is_au_end) {
