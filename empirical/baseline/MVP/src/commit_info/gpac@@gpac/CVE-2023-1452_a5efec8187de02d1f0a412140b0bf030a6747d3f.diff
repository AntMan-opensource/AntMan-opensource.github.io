commit a5efec8187de02d1f0a412140b0bf030a6747d3f
Author: Aurelien David <aurelien.david@telecom-paristech.fr>
Date:   Tue Feb 7 16:01:42 2023 +0100

    load_text: prevent overflow on long lines conversion to utf8 (#2386)

diff --git a/src/filters/load_text.c b/src/filters/load_text.c
index 8d9be626d..cf8f0e313 100644
--- a/src/filters/load_text.c
+++ b/src/filters/load_text.c
@@ -352,6 +352,12 @@ char *gf_text_get_utf8_line(char *szLine, u32 lineSize, FILE *txt_in, s32 unicod
 			}
 			szLineConv[j] = szLine[i];
 			j++;
+
+			if (j >= GF_ARRAY_LENGTH(szLineConv) - 1) {
+				GF_LOG(GF_LOG_DEBUG, GF_LOG_PARSER, ("[TXTIn] Line too long to convert to utf8 (len: %d)\n", len));
+				break;
+			}
+
 		}
 		szLineConv[j] = 0;
 		strcpy(szLine, szLineConv);
