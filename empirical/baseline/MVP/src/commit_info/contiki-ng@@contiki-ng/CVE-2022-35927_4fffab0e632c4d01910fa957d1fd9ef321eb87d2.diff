commit 4fffab0e632c4d01910fa957d1fd9ef321eb87d2
Author: Nicolas Tsiftes <nicolas.tsiftes@ri.se>
Date:   Fri Jun 4 16:36:20 2021 +0200

    Validate the length in the DIO prefix info option.

diff --git a/os/net/routing/rpl-classic/rpl-icmp6.c b/os/net/routing/rpl-classic/rpl-icmp6.c
index c660fbd2a..91b574570 100644
--- a/os/net/routing/rpl-classic/rpl-icmp6.c
+++ b/os/net/routing/rpl-classic/rpl-icmp6.c
@@ -447,6 +447,14 @@ dio_input(void)
           goto discard;
         }
         dio.prefix_info.length = buffer[i + 2];
+
+        if(dio.prefix_info.length > sizeof(uip_ipaddr_t) * 8) {
+          LOG_WARN("Invalid DAG prefix info, len %u > %u\n",
+                   dio.prefix_info.length, (unsigned)(sizeof(uip_ipaddr_t) * 8));
+          RPL_STAT(rpl_stats.malformed_msgs++);
+          goto discard;
+        }
+
         dio.prefix_info.flags = buffer[i + 3];
         /* valid lifetime is ingnored for now - at i + 4 */
         /* preferred lifetime stored in lifetime */
