commit 86065c6cbdf84e3b49ed4ae2ac1be9a1de5db01f
Author: Ola Liljedahl <ola.liljedahl@arm.com>
Date:   Thu Feb 16 17:43:03 2023 +0100

    Initialize tag size in armv8_dec_aes_gcm_full() (bug fix)
    
    The AES-GCM tag size is initialized to 16 bytes (128 bits). Other tag
    sizes are currently not supported using this API.
    Use the armv8_dec_aes_gcm_from_state() function to use other tag sizes.
    This fixes CVE-2023-26084.
    
    Change-Id: Ie16cd9d2afc6745c9ac715892091a0f0e06be52d
    Reviewed-on: https://eu-gerrit-1.euhpc.arm.com/c/attk/AArch64cryptolib/+/494998
    Tested-by: Ola Liljedahl <ola.liljedahl@arm.com>
    Reviewed-by: Ola Liljedahl <ola.liljedahl@arm.com>

diff --git a/AArch64cryptolib_aes_gcm.c b/AArch64cryptolib_aes_gcm.c
index 56aaf4c..b513cdb 100644
--- a/AArch64cryptolib_aes_gcm.c
+++ b/AArch64cryptolib_aes_gcm.c
@@ -2016,7 +2016,7 @@ operation_result_t decrypt_full(
     uint8_t * plaintext)                               //Outputs
 {
     operation_result_t result_status = SUCCESSFUL_OPERATION;
-    cipher_constants_t cc = { .mode = mode };
+    cipher_constants_t cc = { .mode = mode, .tag_byte_length = 16 };
     cipher_state_t cs = { .counter = { .d = {0,0} } };
     cs.constants = &cc;
 
