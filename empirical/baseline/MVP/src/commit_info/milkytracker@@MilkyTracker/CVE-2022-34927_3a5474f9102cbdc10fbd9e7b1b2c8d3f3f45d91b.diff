commit 3a5474f9102cbdc10fbd9e7b1b2c8d3f3f45d91b
Author: Johannes Schultz <sagamusix@users.noreply.github.com>
Date:   Sun Jun 26 17:53:59 2022 +0200

    Fix possible stack corruption with XM instrument headers claiming a size of less than 4
    
    Closes #275

diff --git a/src/milkyplay/LoaderXM.cpp b/src/milkyplay/LoaderXM.cpp
index f87f5c1..303e349 100644
--- a/src/milkyplay/LoaderXM.cpp
+++ b/src/milkyplay/LoaderXM.cpp
@@ -478,7 +478,7 @@ mp_sint32 LoaderXM::load(XMFileBase& f, XModule* module)
 		
 			f.readDwords(&instr[y].size,1);
 			
-			if (instr[y].size < 29)
+			if (instr[y].size >= 4 && instr[y].size < 29)
 			{
 				mp_ubyte buffer[29];
 				memset(buffer, 0, sizeof(buffer));
