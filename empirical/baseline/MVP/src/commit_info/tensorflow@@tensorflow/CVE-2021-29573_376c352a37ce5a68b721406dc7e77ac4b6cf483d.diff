commit 376c352a37ce5a68b721406dc7e77ac4b6cf483d
Author: Mihai Maruseac <mihaimaruseac@google.com>
Date:   Wed May 5 14:34:54 2021 -0700

    Don't do any work if output tensor is null (prevent div by 0)
    
    PiperOrigin-RevId: 372208700
    Change-Id: Iea6b6293e887ade8538facfdb50fb931e17f511e

diff --git a/tensorflow/core/kernels/maxpooling_op.cc b/tensorflow/core/kernels/maxpooling_op.cc
index 003d2e94b99..ceb6694ed66 100644
--- a/tensorflow/core/kernels/maxpooling_op.cc
+++ b/tensorflow/core/kernels/maxpooling_op.cc
@@ -1088,6 +1088,8 @@ class MaxPoolingGradWithArgmaxOp : public OpKernel {
     OP_REQUIRES_OK(context, context->forward_input_or_allocate_output(
                                 {0}, 0, out_shape, &grad_out));
 
+    if (out_shape.num_elements() == 0) return;  // nothing to be done
+
     LaunchMaxPoolingGradWithArgmax<Device, T>::launch(
         context, params, grad_in, argmax, grad_out, include_batch_in_index_);
   }
