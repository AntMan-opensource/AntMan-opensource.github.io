commit a65411a1d69edfb16b25907ffb8f73556ce36bb7
Author: Mihai Maruseac <mihaimaruseac@google.com>
Date:   Tue Oct 18 21:06:47 2022 -0700

    Fix OOB write in grappler.
    
    Discovered via internal fuzzing.
    
    PiperOrigin-RevId: 482097391

diff --git a/tensorflow/core/grappler/utils/functions.cc b/tensorflow/core/grappler/utils/functions.cc
index 8868465352f..4620886868c 100644
--- a/tensorflow/core/grappler/utils/functions.cc
+++ b/tensorflow/core/grappler/utils/functions.cc
@@ -291,6 +291,11 @@ Status MakeGrapplerFunctionItem(const FunctionDef& func,
 
   std::vector<const FunctionDef::ArgAttrs*> arg_attr(inputs.size(), nullptr);
   for (const auto& attr : func.arg_attr()) {
+    if (attr.first >= inputs.size()) {
+      return errors::InvalidArgument("Invalid attribute index, got ",
+                                     attr.first, " but expected less than ",
+                                     inputs.size());
+    }
     arg_attr.at(attr.first) = &attr.second;
   }
 
