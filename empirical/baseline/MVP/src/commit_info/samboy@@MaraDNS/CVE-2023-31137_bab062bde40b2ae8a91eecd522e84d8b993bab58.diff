commit bab062bde40b2ae8a91eecd522e84d8b993bab58
Author: Sam Trenholme <git@samiam.org>
Date:   Tue May 2 16:35:04 2023 -0700

    Fix long standing issue in this code from 2002

diff --git a/dns/Decompress.c b/dns/Decompress.c
index 24d88d5..ae8aa2e 100644
--- a/dns/Decompress.c
+++ b/dns/Decompress.c
@@ -1,4 +1,4 @@
-/* Copyright (c) 2002-2006 Sam Trenholme
+/* Copyright (c) 2002-2023 Sam Trenholme
  *
  * TERMS
  *
@@ -884,7 +884,7 @@ int decomp_get_rddata(js_string *compressed, js_string *out,
             /* Variable length data (length determined by rdlength) */
             else if(subtype == RRSUB_VARIABLE) {
                 len = rdlength - total;
-                if(len == 0) {
+                if(len <= 0) {
                     break;
                     }
                 if(decomp_append_bytes(compressed,out,
