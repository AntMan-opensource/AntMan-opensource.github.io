commit 8ac9a080bee25e67e49bd138d81c992ce7b6d899
Author: Michael Methner <mmethner@de.adit-jv.com>
Date:   Fri Jan 27 10:51:07 2023 +0100

    Check for negative index in dlt_file_message
    
    Fixes #436
    
    Signed-off-by: Michael Methner <mmethner@de.adit-jv.com>

diff --git a/src/shared/dlt_common.c b/src/shared/dlt_common.c
index 6737251..97766f7 100644
--- a/src/shared/dlt_common.c
+++ b/src/shared/dlt_common.c
@@ -1718,7 +1718,7 @@ DltReturnValue dlt_file_message(DltFile *file, int index, int verbose)
         return DLT_RETURN_WRONG_PARAMETER;
 
     /* check if message is in range */
-    if (index >= file->counter) {
+    if (index < 0 || index >= file->counter) {
         dlt_vlog(LOG_WARNING, "Message %d out of range!\r\n", index);
         return DLT_RETURN_WRONG_PARAMETER;
     }
