commit e7177cc04092c6fac65a9468a08b4a07504a8ad4
Author: Robert Kausch <robert.kausch@freac.org>
Date:   Mon Apr 3 14:58:02 2023 +0200

    Fix possible heap buffer overflow in MP4GetVideoProfileLevel().

diff --git a/src/mp4.cpp b/src/mp4.cpp
index 2b37da6..c56f3ee 100644
--- a/src/mp4.cpp
+++ b/src/mp4.cpp
@@ -515,7 +515,7 @@ MP4FileHandle MP4ModifyCallbacks(const MP4IOCallbacks* callbacks,
                                                    &foo,
                                                    &bufsize)) {
                         uint8_t *ptr = foo;
-                        while (bufsize > 0) {
+                        while (bufsize >= 5) {
                             if (MP4V2_HTONL(*(uint32_t *)ptr) == 0x1b0) {
                                 uint8_t ret = ptr[4];
                                 free(foo);
