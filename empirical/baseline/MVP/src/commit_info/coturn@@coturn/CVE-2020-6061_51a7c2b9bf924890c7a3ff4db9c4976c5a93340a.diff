commit 51a7c2b9bf924890c7a3ff4db9c4976c5a93340a
Author: Mészáros Mihály <misi@majd.eu>
Date:   Mon Feb 17 10:34:56 2020 +0100

    Fix: CVE-2020-6061/TALOS-2020-0984

diff --git a/src/apps/relay/http_server.c b/src/apps/relay/http_server.c
index 573af49..1126b49 100644
--- a/src/apps/relay/http_server.c
+++ b/src/apps/relay/http_server.c
@@ -103,7 +103,7 @@ const char* get_http_date_header()
 
 static struct headers_list * post_parse(char *data, size_t data_len)
 {
-	while((*data=='\r')||(*data=='\n')) ++data;
+	while((*data=='\r')||(*data=='\n')) { ++data; --data_len; }
 	char *post_data = (char*)calloc(data_len + 1, sizeof(char));
 	memcpy(post_data, data, data_len);
 	char *fmarker = NULL;
