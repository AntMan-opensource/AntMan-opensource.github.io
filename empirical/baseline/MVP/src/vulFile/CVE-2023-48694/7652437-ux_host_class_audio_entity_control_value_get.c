















































































UINT  _ux_host_class_audio_entity_control_value_get(UX_HOST_CLASS_AUDIO *audio, UX_HOST_CLASS_AUDIO_CONTROL *audio_control)
{

UINT            status;
UCHAR           *control_buffer;
ULONG           actual_size;

    
    UX_TRACE_IN_LINE_INSERT(UX_TRACE_HOST_CLASS_AUDIO_CONTROL_VALUE_GET, audio, audio_control -> ux_host_class_audio_control_entity, 0, 0, UX_TRACE_HOST_CLASS_EVENTS, 0, 0)

    
    if (_ux_host_stack_class_instance_verify(_ux_system_host_class_audio_name, (VOID *) audio) != UX_SUCCESS)
    {

        
        _ux_system_error_handler(UX_SYSTEM_LEVEL_THREAD, UX_SYSTEM_CONTEXT_CLASS, UX_HOST_CLASS_INSTANCE_UNKNOWN);

        
        UX_TRACE_IN_LINE_INSERT(UX_TRACE_ERROR, UX_HOST_CLASS_INSTANCE_UNKNOWN, audio, 0, 0, UX_TRACE_ERRORS, 0, 0)

        return(UX_HOST_CLASS_INSTANCE_UNKNOWN);
    }

    
    _ux_host_mutex_on(&audio -> ux_host_class_audio_mutex);

    
    control_buffer =  _ux_utility_memory_allocate(UX_SAFE_ALIGN, UX_CACHE_SAFE_MEMORY, 4);
    if (control_buffer == UX_NULL)
    {

        
        _ux_host_mutex_off(&audio -> ux_host_class_audio_mutex);

        
        return(UX_MEMORY_INSUFFICIENT);
    }

    
    * (ULONG *)control_buffer = 0;

    
    status = _ux_host_class_audio_control_request(audio, 0, UX_REQUEST_IN | UX_REQUEST_TYPE_CLASS | UX_REQUEST_TARGET_INTERFACE,  (_ux_host_class_audio_protocol_get(audio) == UX_HOST_CLASS_AUDIO_PROTOCOL_IP_VERSION_02_00) ? UX_CLASS_AUDIO20_CUR : UX_HOST_CLASS_AUDIO_GET_CUR,  UX_HOST_CLASS_AUDIO_GET_CUR,  audio_control -> ux_host_class_audio_control_channel | (audio_control -> ux_host_class_audio_control << 8), audio_control -> ux_host_class_audio_control_entity, control_buffer, 4, &actual_size);











    
    if (status == UX_SUCCESS)
    {

        
        audio_control -> ux_host_class_audio_control_cur = _ux_utility_long_get(control_buffer);
    }

    
    _ux_utility_memory_free(control_buffer);

    
    _ux_host_mutex_off(&audio -> ux_host_class_audio_mutex);

    
    return(status);
}
