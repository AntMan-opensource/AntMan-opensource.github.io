



namespace mp4v2 { namespace impl {



MP4FtypAtom::MP4FtypAtom(MP4File &file)
    : MP4Atom( file, "ftyp" )
    , majorBrand       ( *new MP4StringProperty( *this, "majorBrand" ))
    , minorVersion     ( *new MP4Integer32Property( *this, "minorVersion" ))
    , compatibleBrands ( *new MP4StringProperty( *this, "compatibleBrands", false, false, true ))
{
    majorBrand.SetFixedLength( 4 );
    compatibleBrands.SetFixedLength( 4 );

    AddProperty( &majorBrand );
    AddProperty( &minorVersion );
    AddProperty( &compatibleBrands );
}

void MP4FtypAtom::Generate()
{
    MP4Atom::Generate();

    majorBrand.SetValue( "mp42" );
    minorVersion.SetValue( 0 );

    compatibleBrands.SetCount( 2 );
    compatibleBrands.SetValue( "mp42", 0 );
    compatibleBrands.SetValue( "isom", 1 );
}

void MP4FtypAtom::Read()
{
    compatibleBrands.SetCount( (m_size - 8) / 4 ); 
    MP4Atom::Read();
}



}} 
