





mp_err mp_grow(mp_int *a, int size)
{
   int     i;
   mp_digit *tmp;

   
   if (a->alloc < size) {
      
      tmp = (mp_digit *) MP_REALLOC(a->dp, (size_t)a->alloc * sizeof(mp_digit), (size_t)size * sizeof(mp_digit));

      if (tmp == NULL) {
         
         return MP_MEM;
      }

      
      a->dp = tmp;

      
      i        = a->alloc;
      a->alloc = size;
      MP_ZERO_DIGITS(a->dp + i, a->alloc - i);
   }
   return MP_OKAY;
}

