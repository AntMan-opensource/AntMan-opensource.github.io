











struct sss_certmap_ctx;





typedef void (sss_certmap_ext_debug)(void *pvt, const char *file, long line, const char *function, const char *format, ...);



int sss_certmap_init(TALLOC_CTX *mem_ctx, sss_certmap_ext_debug *debug, void *debug_priv, struct sss_certmap_ctx **ctx);



void sss_certmap_free_ctx(struct sss_certmap_ctx *ctx);


int sss_certmap_add_rule(struct sss_certmap_ctx *ctx, uint32_t priority, const char *match_rule, const char *map_rule, const char **domains);



int sss_certmap_match_cert(struct sss_certmap_ctx *ctx, const uint8_t *der_cert, size_t der_size);


int sss_certmap_get_search_filter(struct sss_certmap_ctx *ctx, const uint8_t *der_cert, size_t der_size, char **filter, char ***domains);



void sss_certmap_free_filter_and_domains(char *filter, char **domains);


int sss_certmap_display_cert_content(TALLOC_CTX *mem_cxt, const uint8_t *der_cert, size_t der_size, char **desc);




