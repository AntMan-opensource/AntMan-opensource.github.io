





















typedef struct {
	
	bn_t d;
	
	bn_t e;
	
	crt_t crt;
} _rsa_st;



typedef _rsa_st rsa_t[1];

typedef _rsa_st *rsa_t;




typedef crt_st rabin_t[1];

typedef crt_st *rabin_t;




typedef crt_st phpe_t[1];

typedef crt_st *phpe_t;




typedef struct {
	
	bn_t a;
	
	bn_t b;
	
	bn_t g;
	
	bn_t gn;
	
	crt_t crt;
} shpe_st;



typedef shpe_st shpe_t[1];

typedef shpe_st *shpe_t;



typedef struct {
	
	bn_t n;
	
	bn_t p;
	
	bn_t q;
	
	bn_t y;
	
	dig_t t;
} bdpe_st;



typedef bdpe_st bdpe_t[1];

typedef bdpe_st *bdpe_t;



typedef struct _sokaka {
	
	g1_t s1;
	
	g2_t s2;
} sokaka_st;



typedef sokaka_st sokaka_t[1];

typedef sokaka_st *sokaka_t;



typedef struct {
	
	bn_t x;
	
	bn_t y;
	
	bn_t z;
	
	g1_t gx;
	
	g1_t gy;
	
	g1_t gz;
	
	g2_t hx;
	
	g2_t hy;
	
	g2_t hz;
} bgn_st;



typedef bgn_st bgn_t[1];

typedef bgn_st *bgn_t;



typedef struct _ers_st {
	
    ec_t h;
	
	ec_t pk;
	
	bn_t c[2];
	
	bn_t r[2];
} ers_st;



typedef ers_st ers_t[1];

typedef ers_st *ers_t;



typedef struct _smlers_st {
	
	ers_t sig;
	
	ec_t tau;
	
	bn_t c[2];
	
	bn_t r[2];
} smlers_st;



typedef smlers_st smlers_t[1];

typedef smlers_st *smlers_t;



typedef struct _etrs_st {
	
	bn_t y;
	
    ec_t h;
	
	ec_t pk;
	
	bn_t c[2];
	
	bn_t r[2];
} etrs_st;



typedef etrs_st etrs_t[1];

typedef etrs_st *etrs_t;














































































































































































































































































































































int cp_rsa_gen(rsa_t pub, rsa_t prv, int bits);


int cp_rsa_enc(uint8_t *out, size_t *out_len, const uint8_t *in, size_t in_len, const rsa_t pub);


int cp_rsa_dec(uint8_t *out, size_t *out_len, const uint8_t *in, size_t in_len, const rsa_t prv);


int cp_rsa_sig(uint8_t *sig, size_t *sig_len, const uint8_t *msg, size_t msg_len, int hash, const rsa_t prv);


int cp_rsa_ver(uint8_t *sig, size_t sig_len, const uint8_t *msg, size_t msg_len, int hash, const rsa_t pub);


int cp_rabin_gen(rabin_t pub, rabin_t prv, size_t bits);


int cp_rabin_enc(uint8_t *out, size_t *out_len, const uint8_t *in, size_t in_len, const rabin_t pub);


int cp_rabin_dec(uint8_t *out, size_t *out_len, const uint8_t *in, size_t in_len, const rabin_t prv);


int cp_bdpe_gen(bdpe_t pub, bdpe_t prv, dig_t block, size_t bits);


int cp_bdpe_enc(uint8_t *out, size_t *out_len, dig_t in, const bdpe_t pub);


int cp_bdpe_dec(dig_t *out, const uint8_t *in, size_t in_len, const bdpe_t prv);


int cp_phpe_gen(bn_t pub, phpe_t prv, size_t bits);


int cp_phpe_enc(bn_t c, const bn_t m, const bn_t pub);


int cp_phpe_add(bn_t r, const bn_t c, const bn_t d, const bn_t pub);


int cp_phpe_dec(bn_t m, const bn_t c, const phpe_t prv);


int cp_shpe_gen(shpe_t pub, shpe_t prv, size_t sbits, size_t nbits);


int cp_shpe_enc(bn_t c, const bn_t m, const shpe_t pub);


int cp_shpe_enc_prv(bn_t c, const bn_t m, const shpe_t prv);


int cp_shpe_dec(bn_t m, const bn_t c, const shpe_t prv);


int cp_ghpe_gen(bn_t pub, bn_t prv, size_t bits);


int cp_ghpe_enc(bn_t c, const bn_t m, const bn_t pub, size_t s);


int cp_ghpe_dec(bn_t m, const bn_t c, const bn_t pub, const bn_t prv, size_t s);


int cp_ecdh_gen(bn_t d, ec_t q);


int cp_ecdh_key(uint8_t *key, size_t key_len, const bn_t d, const ec_t q);


int cp_ecmqv_gen(bn_t d, ec_t q);


int cp_ecmqv_key(uint8_t *key, size_t key_len, const bn_t d1, const bn_t d2, const ec_t q2u, const ec_t q1v, const ec_t q2v);


int cp_ecies_gen(bn_t d, ec_t q);


int cp_ecies_enc(ec_t r, uint8_t *out, size_t *out_len, const uint8_t *in, size_t in_len, const ec_t q);


int cp_ecies_dec(uint8_t *out, size_t *out_len, const ec_t r, const uint8_t *in, size_t in_len, const bn_t d);


int cp_ecdsa_gen(bn_t d, ec_t q);


int cp_ecdsa_sig(bn_t r, bn_t s, const uint8_t *msg, size_t len, int hash, const bn_t d);


int cp_ecdsa_ver(const bn_t r, const bn_t s, const uint8_t *msg, size_t len, int hash, const ec_t q);


int cp_ecss_gen(bn_t d, ec_t q);


int cp_ecss_sig(bn_t e, bn_t s, const uint8_t *msg, size_t len, const bn_t d);


int cp_ecss_ver(bn_t e, bn_t s, const uint8_t *msg, size_t len, const ec_t q);


int cp_pdpub_gen(bn_t c, bn_t r, g1_t u1, g2_t u2, g2_t v2, gt_t e);


int cp_pdpub_ask(g1_t v1, g2_t w2, const g1_t p, const g2_t q, const bn_t c, const bn_t r, const g1_t u1, const g2_t u2, const g2_t v2);


int cp_pdpub_ans(gt_t g[3], const g1_t p, const g2_t q, const g1_t v1, const g2_t v2, const g2_t w2);


int cp_pdpub_ver(gt_t r, const gt_t g[3], const bn_t c, const gt_t e);


int cp_pdprv_gen(bn_t c, bn_t r[3], g1_t u1[2], g2_t u2[2], g2_t v2[4], gt_t e[2]);


int cp_pdprv_ask(g1_t v1[3], g2_t w2[4], const g1_t p, const g2_t q, const bn_t c, const bn_t r[3], const g1_t u1[2], const g2_t u2[2], const g2_t v2[4]);



int cp_pdprv_ans(gt_t g[4], const g1_t v1[3], const g2_t w2[4]);


int cp_pdprv_ver(gt_t r, const gt_t g[4], const bn_t c, const gt_t e[2]);


int cp_lvpub_gen(bn_t r, g1_t u1, g2_t u2, g2_t v2, gt_t e);


int cp_lvpub_ask(bn_t c, g1_t v1, g2_t w2, const g1_t p, const g2_t q, const bn_t r, const g1_t u1, const g2_t u2, const g2_t v2);


int cp_lvpub_ans(gt_t g[2], const g1_t p, const g2_t q, const g1_t v1, const g2_t v2, const g2_t w2);


int cp_lvpub_ver(gt_t r, const gt_t g[2], const bn_t c, const gt_t e);


int cp_lvprv_gen(bn_t c, bn_t r[3], g1_t u1[2], g2_t u2[2], g2_t v2[4], gt_t e[2]);


int cp_lvprv_ask(g1_t v1[3], g2_t w2[4], const g1_t p, const g2_t q, const bn_t c, const bn_t r[3], const g1_t u1[2], const g2_t u2[2], const g2_t v2[4]);



int cp_lvprv_ans(gt_t g[4], const g1_t v1[3], const g2_t w2[4]);


int cp_lvprv_ver(gt_t r, const gt_t g[4], const bn_t c, const gt_t e[2]);


int cp_sokaka_gen(bn_t master);


int cp_sokaka_gen_prv(sokaka_t k, const char *id, bn_t master);


int cp_sokaka_key(uint8_t *key, size_t key_len, const char *id1, const sokaka_t k, const char *id2);


int cp_bgn_gen(bgn_t pub, bgn_t prv);


int cp_bgn_enc1(g1_t out[2], const dig_t in, const bgn_t pub);


int cp_bgn_dec1(dig_t *out, const g1_t in[2], const bgn_t prv);


int cp_bgn_enc2(g2_t out[2], const dig_t in, const bgn_t pub);


int cp_bgn_dec2(dig_t *out, const g2_t in[2], const bgn_t prv);


int cp_bgn_add(gt_t e[4], const gt_t c[4], const gt_t d[4]);


int cp_bgn_mul(gt_t e[4], const g1_t c[2], const g2_t d[2]);


int cp_bgn_dec(dig_t *out, const gt_t in[4], const bgn_t prv);


int cp_ibe_gen(bn_t master, g1_t pub);


int cp_ibe_gen_prv(g2_t prv, const char *id, const bn_t master);


int cp_ibe_enc(uint8_t *out, size_t *out_len, const uint8_t *in, size_t in_len, const char *id, const g1_t pub);


int cp_ibe_dec(uint8_t *out, size_t *out_len, const uint8_t *in, size_t in_len, const g2_t prv);


int cp_bls_gen(bn_t d, g2_t q);


int cp_bls_sig(g1_t s, const uint8_t *msg, int len, const bn_t d);


int cp_bls_ver(const g1_t s, const uint8_t *msg, size_t len, const g2_t q);


int cp_bbs_gen(bn_t d, g2_t q, gt_t z);


int cp_bbs_sig(g1_t s, const uint8_t *msg, size_t len, int hash, const bn_t d);


int cp_bbs_ver(g1_t s, const uint8_t *msg, size_t len, int hash, const g2_t q, const gt_t z);


int cp_cls_gen(bn_t u, bn_t v, g2_t x, g2_t y);


int cp_cls_sig(g1_t a, g1_t b, g1_t c, const uint8_t *msg, size_t len, const bn_t u, const bn_t v);


int cp_cls_ver(const g1_t a, const g1_t b, const g1_t c, const uint8_t *msg, size_t len, const g2_t x, const g2_t y);


int cp_cli_gen(bn_t t, bn_t u, bn_t v, g2_t x, g2_t y, g2_t z);


int cp_cli_sig(g1_t a, g1_t A, g1_t b, g1_t B, g1_t c, const uint8_t *msg, size_t len, const bn_t r, const bn_t t, const bn_t u, const bn_t v);


int cp_cli_ver(g1_t a, g1_t A, g1_t b, g1_t B, g1_t c, const uint8_t *msg, size_t len, const bn_t r, const g2_t x, const g2_t y, const g2_t z);


int cp_clb_gen(bn_t t, bn_t u, bn_t v[], g2_t x, g2_t y, g2_t z[], size_t l);


int cp_clb_sig(g1_t a, g1_t A[], g1_t b, g1_t B[], g1_t c, const uint8_t *ms[], const size_t ls[], const bn_t t, const bn_t u, const bn_t v[], const size_t l);



int cp_clb_ver(const g1_t a, const g1_t A[], const g1_t b, const g1_t B[], const g1_t c, const uint8_t *ms[], const size_t ls[], const g2_t x, const g2_t y, const g2_t z[], size_t l);



int cp_pss_gen(bn_t u, bn_t v, g2_t g, g2_t x, g2_t y);


int cp_pss_sig(g1_t a, g1_t b, const bn_t m, const bn_t u, const bn_t v);


int cp_pss_ver(const g1_t a, const g1_t b, const bn_t m, const g2_t g, const g2_t x, const g2_t y);


int cp_mpss_gen(bn_t r[2], bn_t s[2], g2_t g, g2_t x[2], g2_t y[2]);


int cp_mpss_sig(g1_t a, g1_t b[2], const bn_t m[2], const bn_t r[2], const bn_t s[2], const mt_t mul_tri[2], const mt_t sm_tri[2]);


int cp_mpss_bct(g2_t x[2], g2_t y[2]);


int cp_mpss_ver(gt_t e, const g1_t a, const g1_t b[2], const bn_t m[2], const g2_t h, const g2_t x, const g2_t y, const mt_t sm_tri[2], const pt_t pc_tri[2]);



int cp_psb_gen(bn_t r, bn_t s[], g2_t g, g2_t x, g2_t y[], size_t l);


int cp_psb_sig(g1_t a, g1_t b, const bn_t ms[], const bn_t r, const bn_t s[], size_t l);


int cp_psb_ver(const g1_t a, const g1_t b, const bn_t ms[], const g2_t g, const g2_t x, const g2_t y[], size_t l);


int cp_mpsb_gen(bn_t r[2], bn_t s[][2], g2_t h, g2_t x[2], g2_t y[][2], size_t l);


int cp_mpsb_sig(g1_t a, g1_t b[2], const bn_t m[][2], const bn_t r[2], const bn_t s[][2], const mt_t mul_tri[2], const mt_t sm_tri[2], size_t l);



int cp_mpsb_bct(g2_t x[2], g2_t y[][2], size_t l);


int cp_mpsb_ver(gt_t e, const g1_t a, const g1_t b[2], const bn_t m[][2], const g2_t h, const g2_t x, const g2_t y[][2], const bn_t v[][2], const mt_t sm_tri[2], const pt_t pc_tri[2], size_t l);



int cp_zss_gen(bn_t d, g1_t q, gt_t z);


int cp_zss_sig(g2_t s, const uint8_t *msg, size_t len, int hash, const bn_t d);


int cp_zss_ver(const g2_t s, const uint8_t *msg, size_t len, int hash, const g1_t q, const gt_t z);


int cp_vbnn_gen(bn_t msk, ec_t mpk);


int cp_vbnn_gen_prv(bn_t sk, ec_t pk, const bn_t msk, const uint8_t *id, size_t id_len);


int cp_vbnn_sig(ec_t r, bn_t z, bn_t h, const uint8_t *id, size_t id_len, const uint8_t *msg, int msg_len, const bn_t sk, const ec_t pk);


int cp_vbnn_ver(const ec_t r, const bn_t z, const bn_t h, const uint8_t *id, size_t id_len, const uint8_t *msg, int msg_len, const ec_t mpk);


int cp_pokdl_prv(bn_t c, bn_t r, const ec_t y, const bn_t x);


int cp_pokdl_ver(const bn_t c, const bn_t r, const ec_t y);


int cp_pokor_prv(bn_t c[2], bn_t r[2], const ec_t y[2], const bn_t x);


int cp_pokor_ver(const bn_t c[2], const bn_t r[2], const ec_t y[2]);


int cp_sokdl_sig(bn_t c, bn_t r, const uint8_t *msg, size_t len, const ec_t y, const bn_t x);


int cp_sokdl_ver(const bn_t c, const bn_t r, const uint8_t *msg, size_t len, const ec_t y);


int cp_sokor_sig(bn_t c[2], bn_t r[2], const uint8_t *msg, size_t len, const ec_t y[2], const ec_t g[2], const bn_t x, int first);


int cp_sokor_ver(const bn_t c[2], const bn_t r[2], const uint8_t *msg, size_t len, const ec_t y[2], const ec_t g[2]);


int cp_ers_gen(ec_t pp);


int cp_ers_gen_key(bn_t sk, ec_t pk);


int cp_ers_sig(bn_t td, ers_t p, const uint8_t *msg, size_t len, const bn_t sk, const ec_t pk, const ec_t pp);


int cp_ers_ver(const bn_t td, const ers_t *s, size_t size, const uint8_t *msg, size_t len, const ec_t pp);


int cp_ers_ext(bn_t td, ers_t *p, size_t *size, const uint8_t *msg, size_t len, const ec_t pk, const ec_t pp);


int cp_smlers_sig(bn_t td, smlers_t p, const uint8_t *msg, size_t len, const bn_t sk, const ec_t pk, const ec_t pp);


int cp_smlers_ver(bn_t td, smlers_t *s, size_t size, const uint8_t *msg, size_t len, const ec_t pp);


int cp_smlers_ext(bn_t td, smlers_t *p, size_t *size, const uint8_t *msg, size_t len, const ec_t pk, const ec_t pp);


int cp_etrs_sig(bn_t *td, bn_t *y, size_t max, etrs_t p, const uint8_t *msg, size_t len, const bn_t sk, const ec_t pk, const ec_t pp);


int cp_etrs_ver(size_t thres, const bn_t *td, const bn_t *y, size_t max, const etrs_t *s, size_t size, const uint8_t *msg, size_t len, const ec_t pp);



int cp_etrs_ext(bn_t *td, bn_t *y, size_t max, etrs_t *p, size_t *size, const uint8_t *msg, size_t len, const ec_t pk, const ec_t pp);

int cp_etrs_uni(int thres, bn_t *td, bn_t *y, int max, etrs_t *p, size_t *size, const uint8_t *msg, size_t len, const bn_t sk, const ec_t pk, const ec_t pp);


int cp_cmlhs_init(g1_t h);


int cp_cmlhs_gen(bn_t x[], gt_t hs[], size_t len, uint8_t prf[], size_t plen, bn_t sk, g2_t pk, bn_t d, g2_t y, int bls);


int cp_cmlhs_sig(g1_t sig, g2_t z, g1_t a, g1_t c, g1_t r, g2_t s, const bn_t msg, const char *data, int label, const bn_t x, const g1_t h, const uint8_t prf[], size_t plen, const bn_t sk, const bn_t d, int bls);



int cp_cmlhs_fun(g1_t a, g1_t c, const g1_t as[], const g1_t cs[], const dig_t f[], size_t len);


int cp_cmlhs_evl(g1_t r, g2_t s, const g1_t rs[], const g2_t ss[], const dig_t f[], size_t len);


int cp_cmlhs_ver(const g1_t r, const g2_t s, const g1_t sig[], const g2_t z[], const g1_t a[], const g1_t c[], const bn_t m, const char *data, const g1_t h, const int label[], const gt_t * hs[], const dig_t *f[], const size_t flen[], const g2_t y[], const g2_t pk[], size_t slen, int bls);





void cp_cmlhs_off(gt_t vk, const g1_t h, const int label[], const gt_t *hs[], const dig_t *f[], const size_t flen[], size_t slen);


int cp_cmlhs_onv(const g1_t r, const g2_t s, const g1_t sig[], const g2_t z[], const g1_t a[], const g1_t c[], const bn_t msg, const char *data, const g1_t h, const gt_t vk, const g2_t y[], const g2_t pk[], size_t slen, int bls);



int cp_mklhs_gen(bn_t sk, g2_t pk);


int cp_mklhs_sig(g1_t s, const bn_t m, const char *data, const char *id, const char *tag, const bn_t sk);


int cp_mklhs_fun(bn_t mu, const bn_t m[], const dig_t f[], size_t len);


int cp_mklhs_evl(g1_t sig, const g1_t s[], const dig_t f[], size_t len);


int cp_mklhs_ver(const g1_t sig, const bn_t m, const bn_t mu[], const char *data, const char *id[], const char *tag[], const dig_t *f[], const size_t flen[], const g2_t pk[], size_t slen);



int cp_mklhs_off(g1_t h[], dig_t ft[], const char *id[], const char *tag[], const dig_t *f[], const size_t flen[], size_t slen);


int cp_mklhs_onv(const g1_t sig, const bn_t m, const bn_t mu[], const char *data, const char *id[], const g1_t h[], const dig_t ft[], const g2_t pk[], size_t slen);



int cp_rsapsi_gen(bn_t g, bn_t n, size_t bits);


int cp_rsapsi_ask(bn_t d, bn_t r, bn_t p[], const bn_t g, const bn_t n, const bn_t x[], size_t m);


int cp_rsapsi_ans(bn_t t[], bn_t u[], const bn_t d, const bn_t g, const bn_t n, const bn_t y[], size_t l);


int cp_rsapsi_int(bn_t z[], size_t *len, const bn_t r, const bn_t p[], const bn_t n, const bn_t x[], const size_t m, const bn_t t[], const bn_t u[], size_t l);



int cp_shipsi_gen(bn_t g, crt_t crt, size_t bits);


int cp_shipsi_ask(bn_t d, bn_t r, bn_t p[], const bn_t g, const bn_t n, const bn_t x[], size_t m);


int cp_shipsi_ans(bn_t t[], bn_t u, bn_t d, const bn_t g, const crt_t crt, const bn_t y[], const size_t n);


int cp_shipsi_int(bn_t z[], size_t *len, const bn_t r, const bn_t p[], const bn_t n, const bn_t x[], size_t m, const bn_t t[], const bn_t u, size_t l);



int cp_pbpsi_gen(bn_t sk, g1_t ss, g2_t s[], size_t m);


int cp_pbpsi_ask(g2_t d[], bn_t r, const bn_t x[], const g2_t s[], size_t m);


int cp_pbpsi_ans(gt_t t[], g1_t u[], const g1_t ss, const g2_t d, const bn_t y[], size_t n);


int cp_pbpsi_int(bn_t z[], size_t *len, const g2_t d[], const bn_t x[], size_t m, const gt_t t[], const g1_t u[], size_t n);


