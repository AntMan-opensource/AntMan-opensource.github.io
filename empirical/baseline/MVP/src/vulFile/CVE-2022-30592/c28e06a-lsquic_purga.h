





struct lsquic_purga;


enum purga_type {
    PUTY_CONN_DELETED,   PUTY_CONN_DRAIN, PUTY_CID_RETIRED, };




struct purga_el {
    enum purga_type             puel_type;
    
    unsigned                    puel_count;
    lsquic_time_t               puel_time;
};

struct lsquic_purga * lsquic_purga_new (lsquic_time_t min_life, lsquic_cids_update_f remove_cids, void *remove_ctx);


struct purga_el * lsquic_purga_add (struct lsquic_purga *, const lsquic_cid_t *, void *peer_ctx, enum purga_type, lsquic_time_t);


struct purga_el * lsquic_purga_contains (struct lsquic_purga *, const lsquic_cid_t *);

void lsquic_purga_destroy (struct lsquic_purga *);

unsigned lsquic_purga_cids_per_page (void);


struct purga_bloom_stats {
    unsigned long   searches;
    unsigned long   false_hits;
};

struct purga_bloom_stats * lsquic_purga_get_bloom_stats (struct lsquic_purga *);



