





struct frame_buf {
    TAILQ_ENTRY(frame_buf)  frab_next;
    unsigned short          frab_size, frab_off, frab_buf_size;

    unsigned char           frab_buf[0];
};





TAILQ_HEAD(frame_buf_head, frame_buf);

struct frab_list {
    struct frame_buf_head   fl_frabs;
    void *                (*fl_alloc)(void *alloc_ctx, size_t size);
    void                  (*fl_free)(void *alloc_ctx, void *obj);
    void                   *fl_alloc_ctx;
    size_t                  fl_size;        
    unsigned short          fl_buf_size;    
};

void lsquic_frab_list_init (struct frab_list *, unsigned short buf_size, void * (*fl_alloc)(void *alloc_ctx, size_t size), void (*fl_free)(void *alloc_ctx, void *obj), void *fl_alloc_ctx);



void lsquic_frab_list_cleanup (struct frab_list *);

int lsquic_frab_list_write (struct frab_list *, const void *, size_t);

size_t lsquic_frab_list_size (void *);

size_t lsquic_frab_list_read (void *, void *, size_t);



size_t lsquic_frab_list_mem_used (const struct frab_list *);


