






struct data_frame;
struct data_in;
struct lsquic_conn_public;
struct stream_frame;


enum ins_frame {
    INS_FRAME_OK, INS_FRAME_ERR, INS_FRAME_DUP, INS_FRAME_OVERLAP, };





struct data_in_iface {
    void (*di_destroy) (struct data_in *);

    int (*di_empty) (struct data_in *);

    
    enum ins_frame (*di_insert_frame) (struct data_in *, struct stream_frame *, uint64_t read_offset);


    struct data_frame * (*di_get_frame) (struct data_in *, uint64_t read_offset);

    void (*di_frame_done) (struct data_in *, struct data_frame *);

    
    struct data_in * (*di_switch_impl) (struct data_in *, uint64_t read_offset);

    size_t (*di_mem_used) (struct data_in *);

    void (*di_dump_state) (struct data_in *);

    
    uint64_t (*di_readable_bytes) (struct data_in *, uint64_t read_offset);

    
    const int di_own_on_ok;
};


struct data_in {
    const struct data_in_iface  *di_if;
    enum {
        
        DI_SWITCH_IMPL = (1 << 0), }                            di_flags;
};



struct data_in * lsquic_data_in_nocopy_new (struct lsquic_conn_public *, lsquic_stream_id_t);


struct data_in * lsquic_data_in_hash_new (struct lsquic_conn_public *, lsquic_stream_id_t, uint64_t byteage);


enum ins_frame lsquic_data_in_hash_insert_data_frame (struct data_in *data_in, const struct data_frame *data_frame, uint64_t read_offset);


struct data_in * lsquic_data_in_error_new ();


