

















void lsquic_rtt_stats_update (struct lsquic_rtt_stats *stats, lsquic_time_t send_delta, lsquic_time_t lack_delta)

{
    if (send_delta > lack_delta)
        send_delta -= lack_delta;
    if (stats->srtt) {
        stats->rttvar -= stats->rttvar >> BETA_SHIFT;
        
        
        
        stats->rttvar += (llabs((int64_t) (send_delta - stats->srtt)))
                                                            >> BETA_SHIFT;
        stats->srtt -= stats->srtt >> ALPHA_SHIFT;
        stats->srtt += send_delta >> ALPHA_SHIFT;
        if (send_delta < stats->min_rtt)
            stats->min_rtt = send_delta;
    } else {
        
        stats->srtt   = send_delta;
        stats->rttvar = send_delta >> 1;
        stats->min_rtt = send_delta;
    }
}
