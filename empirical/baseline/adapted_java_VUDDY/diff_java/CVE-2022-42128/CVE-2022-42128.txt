commit 662626e11b7cafcc073e6b5e3e5b8ba188a1d792
Author: Luismi Barcos <luismiguel.barcos@liferay.com>
Date:   Mon Nov 8 14:22:46 2021 +0100

    LPS-142173 Check permissions before return a WikiNode

diff --git a/modules/apps/headless/headless-delivery/headless-delivery-impl/src/main/java/com/liferay/headless/delivery/internal/resource/v1_0/WikiNodeResourceImpl.java b/modules/apps/headless/headless-delivery/headless-delivery-impl/src/main/java/com/liferay/headless/delivery/internal/resource/v1_0/WikiNodeResourceImpl.java
index 3ca92b3bb4ef5..b86d995b33648 100644
--- a/modules/apps/headless/headless-delivery/headless-delivery-impl/src/main/java/com/liferay/headless/delivery/internal/resource/v1_0/WikiNodeResourceImpl.java
+++ b/modules/apps/headless/headless-delivery/headless-delivery-impl/src/main/java/com/liferay/headless/delivery/internal/resource/v1_0/WikiNodeResourceImpl.java
@@ -34,6 +34,7 @@ import com.liferay.portal.vulcan.dto.converter.DTOConverterRegistry;
 import com.liferay.portal.vulcan.dto.converter.DefaultDTOConverterContext;
 import com.liferay.portal.vulcan.pagination.Page;
 import com.liferay.portal.vulcan.pagination.Pagination;
+import com.liferay.portal.vulcan.permission.PermissionUtil;
 import com.liferay.portal.vulcan.resource.EntityModelResource;
 import com.liferay.portal.vulcan.util.SearchUtil;
 import com.liferay.wiki.constants.WikiConstants;
@@ -83,9 +84,19 @@ public class WikiNodeResourceImpl
 			Long siteId, String externalReferenceCode)
 		throws Exception {
 
-		return _toWikiNode(
+		com.liferay.wiki.model.WikiNode wikiNode =
 			_wikiNodeLocalService.getWikiNodeByExternalReferenceCode(
-				siteId, externalReferenceCode));
+				siteId, externalReferenceCode);
+
+		String resourceName = getPermissionCheckerResourceName(
+			wikiNode.getNodeId());
+		Long resourceId = getPermissionCheckerResourceId(wikiNode.getNodeId());
+
+		PermissionUtil.checkPermission(
+			ActionKeys.VIEW, groupLocalService, resourceName, resourceId,
+			getPermissionCheckerGroupId(wikiNode.getNodeId()));
+
+		return _toWikiNode(wikiNode);
 	}
 
 	@Override
