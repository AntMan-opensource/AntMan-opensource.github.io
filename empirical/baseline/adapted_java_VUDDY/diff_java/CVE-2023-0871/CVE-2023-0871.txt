commit 5a3b0b62e0c612c9e2aa2c91c847abec71d767d5
Author: Dustin Frisch <dustin@opennms.com>
Date:   Thu Jul 13 13:51:30 2023 +0200

    NMS-15699: Prevent external xml entity loading

diff --git a/core/xml/src/main/java/org/opennms/core/xml/JaxbUtils.java b/core/xml/src/main/java/org/opennms/core/xml/JaxbUtils.java
index 13f5fab2f61..60c78c1f340 100644
--- a/core/xml/src/main/java/org/opennms/core/xml/JaxbUtils.java
+++ b/core/xml/src/main/java/org/opennms/core/xml/JaxbUtils.java
@@ -305,9 +305,9 @@ public abstract class JaxbUtils {
         final XMLReader xmlReader = XMLReaderFactory.createXMLReader();
         if (disableDOCTYPE) {
             xmlReader.setFeature("http://apache.org/xml/features/disallow-doctype-decl", true);
-            xmlReader.setFeature("http://xml.org/sax/features/external-general-entities", false);
-            xmlReader.setFeature("http://xml.org/sax/features/external-parameter-entities", false);
         }
+        xmlReader.setFeature("http://xml.org/sax/features/external-general-entities", false);
+        xmlReader.setFeature("http://xml.org/sax/features/external-parameter-entities", false);
         xmlReader.setFeature("http://apache.org/xml/features/nonvalidating/load-external-dtd", false);
 
         filter.setParent(xmlReader);
