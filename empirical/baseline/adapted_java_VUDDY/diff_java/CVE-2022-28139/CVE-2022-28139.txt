commit 1a0023be9f2e143434d028d5292ef9dc3195d051
Author: Martin Reinhardt <contact@martinreinhardt-online.de>
Date:   Sat Mar 19 11:20:32 2022 +0100

    feat(Security): Improve credential handling

diff --git a/src/main/java/jenkins/plugins/rocketchatnotifier/RocketChatNotifier.java b/src/main/java/jenkins/plugins/rocketchatnotifier/RocketChatNotifier.java
index 21484bf..76ac99d 100644
--- a/src/main/java/jenkins/plugins/rocketchatnotifier/RocketChatNotifier.java
+++ b/src/main/java/jenkins/plugins/rocketchatnotifier/RocketChatNotifier.java
@@ -30,6 +30,7 @@ import org.kohsuke.stapler.DataBoundSetter;
 import org.kohsuke.stapler.QueryParameter;
 import org.kohsuke.stapler.StaplerRequest;
 import org.kohsuke.stapler.export.Exported;
+import org.kohsuke.stapler.interceptor.RequirePOST;
 
 import javax.net.ssl.SSLHandshakeException;
 import java.io.IOException;
@@ -578,6 +579,7 @@ public class RocketChatNotifier extends Notifier {
       return "RocketChat Notifications";
     }
 
+    @RequirePOST
     public FormValidation doTestConnection(@QueryParameter("rocketServerUrl") final String rocketServerUrl,
                                            @QueryParameter("trustSSL") final String trustSSL,
                                            @QueryParameter("username") final String username,
@@ -586,6 +588,7 @@ public class RocketChatNotifier extends Notifier {
                                            @QueryParameter("buildServerUrl") final String buildServerUrl,
                                            @QueryParameter("webhookToken") final String token,
                                            @QueryParameter("webhookTokenCredentialId") final String webhookTokenCredentialId) throws FormException {
+      Jenkins.get().checkPermission(Jenkins.ADMINISTER);
       try {
         String targetServerUrl = rocketServerUrl + RocketClientImpl.API_PATH;
         if (StringUtils.isEmpty(rocketServerUrl)) {
