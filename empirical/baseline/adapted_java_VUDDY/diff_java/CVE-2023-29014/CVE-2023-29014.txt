commit c29efe60e745a94d03debc17681c4950f3917455
Author: Florian Alpers <florian@florian-thinkpad>
Date:   Thu Mar 23 11:22:11 2023 +0100

    Only allow setting logId to a value matching [\w-]+
    
    refs #24571

diff --git a/goobi-viewer-core/src/main/java/io/goobi/viewer/managedbeans/ActiveDocumentBean.java b/goobi-viewer-core/src/main/java/io/goobi/viewer/managedbeans/ActiveDocumentBean.java
index 092a62620b..13619e56c3 100644
--- a/goobi-viewer-core/src/main/java/io/goobi/viewer/managedbeans/ActiveDocumentBean.java
+++ b/goobi-viewer-core/src/main/java/io/goobi/viewer/managedbeans/ActiveDocumentBean.java
@@ -752,7 +752,11 @@ public class ActiveDocumentBean implements Serializable {
                 viewManager.setDropdownSelected(String.valueOf(imageToShow));
             }
             // Reset LOGID (the LOGID setter is called later by PrettyFaces, so if a value is passed, it will still be set)
-            setLogid("");
+            try {
+                setLogid("");
+            } catch (PresentationException e) {
+                //cannot be thrown here
+            }
             logger.trace("imageToShow: {}", this.imageToShow);
         }
     }
@@ -776,13 +780,16 @@ public class ActiveDocumentBean implements Serializable {
      * </p>
      *
      * @param logid the logid to set
+     * @throws PresentationException 
      */
-    public void setLogid(String logid) {
+    public void setLogid(String logid) throws PresentationException {
         synchronized (this) {
             if ("-".equals(logid)) {
                 this.logid = "";
-            } else {
+            } else if(StringUtils.isNotBlank(logid) && logid.matches("[\\w-]+")) {
                 this.logid = SolrTools.escapeSpecialCharacters(logid);
+            } else {
+                throw new PresentationException("The passed logId " + SolrTools.escapeSpecialCharacters(logid) + " contains illegal characters");
             }
         }
     }
