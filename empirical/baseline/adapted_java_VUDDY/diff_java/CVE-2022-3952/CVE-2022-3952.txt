commit 94653cb357806c9cf24d8d294e6afea33f8f0775
Author: Jonathan Leitschuh <Jonathan.Leitschuh@gmail.com>
Date:   Tue Oct 4 00:22:10 2022 +0000

    vuln-fix: Temporary Directory Hijacking or Information Disclosure
    
    
    
    This fixes either Temporary Directory Hijacking, or Temporary Directory Local Information Disclosure.
    
    Weakness: CWE-379: Creation of Temporary File in Directory with Insecure Permissions
    Severity: High
    CVSSS: 7.3
    Detection: CodeQL & OpenRewrite (https://public.moderne.io/recipes/org.openrewrite.java.security.UseFilesCreateTempDirectory)
    
    Reported-by: Jonathan Leitschuh <Jonathan.Leitschuh@gmail.com>
    Signed-off-by: Jonathan Leitschuh <Jonathan.Leitschuh@gmail.com>
    
    Bug-tracker: https://github.com/JLLeitschuh/security-research/issues/10
    
    
    Co-authored-by: Moderne <team@moderne.io>

diff --git a/microservices/launcher/src/main/java/com/manydesigns/portofino/microservices/launcher/WarFileLauncher.java b/microservices/launcher/src/main/java/com/manydesigns/portofino/microservices/launcher/WarFileLauncher.java
index 5e8ea8c8e..dec746aef 100644
--- a/microservices/launcher/src/main/java/com/manydesigns/portofino/microservices/launcher/WarFileLauncher.java
+++ b/microservices/launcher/src/main/java/com/manydesigns/portofino/microservices/launcher/WarFileLauncher.java
@@ -9,6 +9,7 @@ import java.net.URI;
 import java.net.URISyntaxException;
 import java.net.URL;
 import java.net.URLClassLoader;
+import java.nio.file.Files;
 import java.util.ArrayList;
 import java.util.Enumeration;
 import java.util.List;
@@ -80,9 +81,7 @@ public class WarFileLauncher {
      * Returns the absolute path to the temp directory.
      */
     public static File createTempDir(int port) throws IOException {
-        File tempDir = File.createTempFile("portofino.tomcat.", "." + port);
-        tempDir.delete();
-        tempDir.mkdir();
+        File tempDir = Files.createTempDirectory("portofino.tomcat." + "." + port).toFile();
         tempDir.deleteOnExit();
         return tempDir;
     }
