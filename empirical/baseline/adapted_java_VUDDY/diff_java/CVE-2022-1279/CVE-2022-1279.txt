commit df9f58be7c782af27414c354a36a8c250ca883ca
Author: Uwe Maurer <uwe@apptornado.com>
Date:   Fri Apr 8 15:11:12 2022 +0200

    use nextBytes instead of generateSeed. delete unused generatePassword

diff --git a/src/main/java/org/kopi/ebics/certificate/KeyUtil.java b/src/main/java/org/kopi/ebics/certificate/KeyUtil.java
index 9a759e6..d0280a1 100644
--- a/src/main/java/org/kopi/ebics/certificate/KeyUtil.java
+++ b/src/main/java/org/kopi/ebics/certificate/KeyUtil.java
@@ -61,16 +61,6 @@ public class KeyUtil {
 
   }
 
-  /**
-   * Generates a random password
-   *
-   * @return the password
-   */
-  public static String generatePassword() {
-      String pwd = Base64.encodeBase64String(Utils.secureRandom.generateSeed(5));
-      return pwd.substring(0, pwd.length() - 2);
-  }
-
   /**
    * Returns the digest value of a given public key.
    *
diff --git a/src/main/java/org/kopi/ebics/utils/Utils.java b/src/main/java/org/kopi/ebics/utils/Utils.java
index 3dd272b..5a4b633 100644
--- a/src/main/java/org/kopi/ebics/utils/Utils.java
+++ b/src/main/java/org/kopi/ebics/utils/Utils.java
@@ -123,11 +123,17 @@ public final class Utils {
    * @return a random nonce.
    */
   public static byte[] generateNonce() {
-    return secureRandom.generateSeed(16);
+    return nextRandomBytes(16);
   }
 
   public static byte[] generateKey() {
-    return secureRandom.generateSeed(16);
+    return nextRandomBytes(16);
+  }
+
+  private static byte[] nextRandomBytes(int n) {
+    byte[] data = new byte[n];
+    secureRandom.nextBytes(data);
+    return data;
   }
 
   /**
