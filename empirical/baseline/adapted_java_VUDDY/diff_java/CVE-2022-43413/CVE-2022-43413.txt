commit 1b4119849571d4879977c529f9972d271ad6a630
Author: Emilio Escobar <escoem@users.noreply.github.com>
Date:   Tue Oct 18 12:06:33 2022 +0200

    [SECURITY-2791]

diff --git a/src/main/java/org/jenkins/ci/plugins/jobimport/JobImportAction.java b/src/main/java/org/jenkins/ci/plugins/jobimport/JobImportAction.java
index 9fd8880..2dbaa13 100644
--- a/src/main/java/org/jenkins/ci/plugins/jobimport/JobImportAction.java
+++ b/src/main/java/org/jenkins/ci/plugins/jobimport/JobImportAction.java
@@ -316,6 +316,9 @@ public final class JobImportAction implements RootAction, Describable<JobImportA
     public String getDisplayName() { return ""; }
 
     public ListBoxModel doFillCredentialIdItems() {
+      if (!Jenkins.get().hasPermission(JOB_IMPORT)) {
+        return new StandardListBoxModel();
+      }
       return new StandardListBoxModel()
               .includeEmptyValue()
               .includeMatchingAs(
@@ -334,6 +337,9 @@ public final class JobImportAction implements RootAction, Describable<JobImportA
     }
 
     public ListBoxModel doFillJenkinsSitesItems() {
+      if (!Jenkins.get().hasPermission(JOB_IMPORT)) {
+        return new StandardListBoxModel();
+      }
       final ListBoxModel listBoxModel = new ListBoxModel();
       JobImportGlobalConfig.get().getSites().stream().forEach(s -> listBoxModel.add(s.getName(), s.getName() + "-" + s.getUrl() + "-" + s.getDefaultCredentialsId()));
       return listBoxModel;
