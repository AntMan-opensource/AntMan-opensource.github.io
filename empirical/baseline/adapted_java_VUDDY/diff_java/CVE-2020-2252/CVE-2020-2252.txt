commit e1893c6d105669f134ee5c5212ef9f3944d7d00d
Author: Adrien Lecharpentier <adrien.lecharpentier@gmail.com>
Date:   Thu Sep 3 10:42:49 2020 +0200

    SECURITY-1813

diff --git a/src/main/java/hudson/tasks/Mailer.java b/src/main/java/hudson/tasks/Mailer.java
index d39ac96..2e6f9bd 100644
--- a/src/main/java/hudson/tasks/Mailer.java
+++ b/src/main/java/hudson/tasks/Mailer.java
@@ -383,6 +383,9 @@ public class Mailer extends Notifier implements SimpleBuildStep {
                     props.put("mail.smtp.socketFactory.class","javax.net.ssl.SSLSocketFactory");
             	}
 				props.put("mail.smtp.socketFactory.fallback", "false");
+            	if (props.getProperty("mail.smtp.ssl.checkserveridentity") == null) {
+                    props.put("mail.smtp.ssl.checkserveridentity", "true");
+                }
 			}
 			if(useTls){
                 /* This allows the user to override settings by setting system properties and
