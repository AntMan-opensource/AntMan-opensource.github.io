commit a79f95c7d32ad6a2e161159fa77f371705f3b20d
Author: vaibhjai <vaibhav_jain2@bmc.com>
Date:   Mon May 16 15:15:05 2022 +0530

    SECURITY-2619: Added Missing permission checks.

diff --git a/src/main/java/com/compuware/jenkins/build/JclDescriptorImpl.java b/src/main/java/com/compuware/jenkins/build/JclDescriptorImpl.java
index a13c18e..f2379d4 100644
--- a/src/main/java/com/compuware/jenkins/build/JclDescriptorImpl.java
+++ b/src/main/java/com/compuware/jenkins/build/JclDescriptorImpl.java
@@ -151,6 +151,12 @@ public abstract class JclDescriptorImpl<T extends BuildStep & Describable<T>> ex
 	 */
 	public ListBoxModel doFillConnectionIdItems(@AncestorInPath Jenkins context, @QueryParameter String connectionId,
 			@AncestorInPath Item project) {
+		if (project == null) {
+				Jenkins.get().checkPermission(Jenkins.ADMINISTER);
+		} else {
+			project.checkPermission(Item.CONFIGURE);
+		}
+		
 		CpwrGlobalConfiguration globalConfig = CpwrGlobalConfiguration.get();
 		HostConnection[] hostConnections = globalConfig.getHostConnections();
 
@@ -184,6 +190,12 @@ public abstract class JclDescriptorImpl<T extends BuildStep & Describable<T>> ex
 	 */
 	public ListBoxModel doFillCredentialsIdItems(@AncestorInPath Jenkins context, @QueryParameter String credentialsId,
 			@AncestorInPath Item project) {
+		if (project == null) {
+				Jenkins.get().checkPermission(Jenkins.ADMINISTER);
+		} else {
+			project.checkPermission(Item.CONFIGURE);
+		}
+		
 		List<StandardCredentials> creds = CredentialsProvider.lookupCredentials(StandardCredentials.class,
 				project, ACL.SYSTEM, Collections.<DomainRequirement>emptyList());
 
