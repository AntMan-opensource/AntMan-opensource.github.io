commit 1607837be28438c0ccae8da15afb653f2afed090
Author: Hao <1780095+hnrainll@users.noreply.github.com>
Date:   Mon Nov 27 10:38:36 2023 +0800

    [INLONG-9328][Manager] Add parameters validation for the updateAuditSource method (#9329)

diff --git a/inlong-manager/manager-pojo/src/main/java/org/apache/inlong/manager/pojo/audit/AuditSourceRequest.java b/inlong-manager/manager-pojo/src/main/java/org/apache/inlong/manager/pojo/audit/AuditSourceRequest.java
index 63e0eedec..33b6cd5bf 100644
--- a/inlong-manager/manager-pojo/src/main/java/org/apache/inlong/manager/pojo/audit/AuditSourceRequest.java
+++ b/inlong-manager/manager-pojo/src/main/java/org/apache/inlong/manager/pojo/audit/AuditSourceRequest.java
@@ -25,6 +25,7 @@ import lombok.Data;
 import lombok.NoArgsConstructor;
 
 import javax.validation.constraints.NotBlank;
+import javax.validation.constraints.Pattern;
 
 /**
  * Audit source request
@@ -45,6 +46,7 @@ public class AuditSourceRequest {
     private String type;
 
     @NotBlank
+    @Pattern(regexp = "^(jdbc:(mysql|clickhouse)://[\\w.]+(:\\d+)?/[\\w]+(\\?.*)?|http://[\\w.]+(:\\d+)?(/[\\w]+)+(/\\d+(-\\d+)?(,\\d+(-\\d+)?)*)?)", message = "only supports MYSQL, CLICKHOUSE, ELASTICSEARCH url")
     @ApiModelProperty(value = "Audit source URL, for MYSQL or CLICKHOUSE, is jdbcUrl, and for ELASTICSEARCH is the access URL with hostname:port", required = true)
     private String url;
 
diff --git a/inlong-manager/manager-web/src/main/java/org/apache/inlong/manager/web/controller/AuditController.java b/inlong-manager/manager-web/src/main/java/org/apache/inlong/manager/web/controller/AuditController.java
index 4addf6514..a7128085e 100644
--- a/inlong-manager/manager-web/src/main/java/org/apache/inlong/manager/web/controller/AuditController.java
+++ b/inlong-manager/manager-web/src/main/java/org/apache/inlong/manager/web/controller/AuditController.java
@@ -65,7 +65,7 @@ public class AuditController {
 
     @ApiOperation(value = "Update the audit source")
     @PostMapping(value = "/audit/updateSource")
-    public Response<Integer> updateAuditSource(@RequestBody AuditSourceRequest request) {
+    public Response<Integer> updateAuditSource(@Valid @RequestBody AuditSourceRequest request) {
         return Response.success(auditService.updateAuditSource(request, LoginUserUtils.getLoginUser().getName()));
     }
 
