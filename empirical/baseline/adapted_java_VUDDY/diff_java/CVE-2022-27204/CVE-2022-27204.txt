commit eff9472b64f68749e5272aa59b68e561fb4ab4cd
Author: Christoph Schulz <christoph.2.schulz@atos.net>
Date:   Wed May 25 10:38:33 2022 +0200

    CVE-2022-27204
    
    Implement suggestion from https://www.jenkins.io/doc/developer/security/form-validation/

diff --git a/src/main/java/com/cwctravel/hudson/plugins/extended_choice_parameter/ExtendedChoiceParameterDefinition.java b/src/main/java/com/cwctravel/hudson/plugins/extended_choice_parameter/ExtendedChoiceParameterDefinition.java
index d373497..55701a9 100644
--- a/src/main/java/com/cwctravel/hudson/plugins/extended_choice_parameter/ExtendedChoiceParameterDefinition.java
+++ b/src/main/java/com/cwctravel/hudson/plugins/extended_choice_parameter/ExtendedChoiceParameterDefinition.java
@@ -59,6 +59,7 @@ import org.kohsuke.stapler.DataBoundConstructor;
 import org.kohsuke.stapler.QueryParameter;
 import org.kohsuke.stapler.Stapler;
 import org.kohsuke.stapler.StaplerRequest;
+import org.kohsuke.stapler.verb.POST;
 
 import com.opencsv.CSVReader;
 import groovy.lang.Binding;
@@ -114,6 +115,7 @@ public class ExtendedChoiceParameterDefinition extends ParameterDefinition {
 			return Messages.ExtendedChoiceParameterDefinition_DisplayName();
 		}
 
+		@POST
 		public FormValidation doCheckPropertyFile(@QueryParameter final String propertyFile, @QueryParameter final String propertyKey,
 				@QueryParameter final String type) throws IOException, ServletException {
 			if(StringUtils.isBlank(propertyFile)) {
@@ -158,16 +160,19 @@ public class ExtendedChoiceParameterDefinition extends ParameterDefinition {
 			}
 		}
 
+		@POST
 		public FormValidation doCheckPropertyKey(@QueryParameter final String propertyFile, @QueryParameter final String propertyKey,
 				@QueryParameter final String type) throws IOException, ServletException {
 			return doCheckPropertyFile(propertyFile, propertyKey, type);
 		}
 
+		@POST
 		public FormValidation doCheckDefaultPropertyFile(@QueryParameter final String defaultPropertyFile,
 				@QueryParameter final String defaultPropertyKey, @QueryParameter final String type) throws IOException, ServletException {
 			return doCheckPropertyFile(defaultPropertyFile, defaultPropertyKey, type);
 		}
 
+		@POST
 		public FormValidation doCheckDefaultPropertyKey(@QueryParameter final String defaultPropertyFile,
 				@QueryParameter final String defaultPropertyKey, @QueryParameter final String type) throws IOException, ServletException {
 			return doCheckPropertyFile(defaultPropertyFile, defaultPropertyKey, type);
