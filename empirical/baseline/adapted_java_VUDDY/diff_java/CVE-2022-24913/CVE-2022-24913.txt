commit 450fdee70b5f181c2afc5d817f293efa1a543902
Author: Jonathan Leitschuh <Jonathan.Leitschuh@gmail.com>
Date:   Sat Nov 19 02:05:10 2022 +0000

    vuln-fix: Temporary File Information Disclosure
    
    
    
    This fixes temporary file information disclosure vulnerability due to the use
    of the vulnerable `File.createTempFile()` method. The vulnerability is fixed by
    using the `Files.createTempFile()` method which sets the correct posix permissions.
    
    Weakness: CWE-377: Insecure Temporary File
    Severity: Medium
    CVSSS: 5.5
    Detection: CodeQL & OpenRewrite (https://public.moderne.io/recipes/org.openrewrite.java.security.SecureTempFileCreation)
    
    Reported-by: Jonathan Leitschuh <Jonathan.Leitschuh@gmail.com>
    Signed-off-by: Jonathan Leitschuh <Jonathan.Leitschuh@gmail.com>
    
    Bug-tracker: https://github.com/JLLeitschuh/security-research/issues/18
    
    
    Co-authored-by: Moderne <team@moderne.io>

diff --git a/src/main/java/com/fasterxml/sort/std/StdTempFileProvider.java b/src/main/java/com/fasterxml/sort/std/StdTempFileProvider.java
index d2e37fa..213f9eb 100644
--- a/src/main/java/com/fasterxml/sort/std/StdTempFileProvider.java
+++ b/src/main/java/com/fasterxml/sort/std/StdTempFileProvider.java
@@ -1,6 +1,7 @@
 package com.fasterxml.sort.std;
 
 import java.io.*;
+import java.nio.file.Files;
 
 import com.fasterxml.sort.TempFileProvider;
 
@@ -35,7 +36,7 @@ public class StdTempFileProvider
     @Override
     public File provide() throws IOException
     {
-        File f = File.createTempFile(_prefix, _suffix);
+        File f = Files.createTempFile(_prefix, _suffix).toFile();
         f.deleteOnExit();
         return f;
     }
