commit 1b136cddf908138864cfe1c9c861114f5d263871
Author: Marco Tizzoni <marco.tizzoni@gmail.com>
Date:   Tue Jul 19 14:36:40 2022 +0200

    SECURITY-2403 (#22)
    
    Co-authored-by: Marco Tizzoni <marco.tizzoni@ecb.europa.eu>

diff --git a/src/main/java/jenkins/plugins/rpmsign/RpmSignPlugin.java b/src/main/java/jenkins/plugins/rpmsign/RpmSignPlugin.java
index c33f592..42d23bf 100644
--- a/src/main/java/jenkins/plugins/rpmsign/RpmSignPlugin.java
+++ b/src/main/java/jenkins/plugins/rpmsign/RpmSignPlugin.java
@@ -7,6 +7,7 @@ import hudson.Proc;
 import hudson.model.AbstractBuild;
 import hudson.model.AbstractProject;
 import hudson.model.BuildListener;
+import hudson.model.Item;
 import hudson.model.Result;
 import hudson.tasks.BuildStepDescriptor;
 import hudson.tasks.BuildStepMonitor;
@@ -273,6 +274,7 @@ public class RpmSignPlugin extends Recorder {
     }
 
     public FormValidation doCheckIncludes(@AncestorInPath AbstractProject project, @QueryParameter String value) throws IOException, InterruptedException {
+      project.checkPermission(Item.WORKSPACE);
       FilePath workspace = project.getSomeWorkspace();
       if (workspace != null) {
         String msg = workspace.validateAntFileMask(value);
