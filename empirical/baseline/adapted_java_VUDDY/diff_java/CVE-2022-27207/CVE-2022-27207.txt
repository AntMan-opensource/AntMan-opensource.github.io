commit 214f74360b3a91734b6e2a4b281ff0086a1e0679
Author: balakine <balakine@users.noreply.github.com>
Date:   Fri Mar 31 21:36:50 2023 +0300

    CVE-2022-27207 - fixed stored XSS vulnerability (#38)
    
    * URL encode string parameters
    
    * Use platform default encoding

diff --git a/src/main/java/hudson/plugins/global_build_stats/model/AbstractBuildStatChartDimension.java b/src/main/java/hudson/plugins/global_build_stats/model/AbstractBuildStatChartDimension.java
index 8869e8c..31b9a87 100644
--- a/src/main/java/hudson/plugins/global_build_stats/model/AbstractBuildStatChartDimension.java
+++ b/src/main/java/hudson/plugins/global_build_stats/model/AbstractBuildStatChartDimension.java
@@ -5,6 +5,7 @@ import hudson.util.DataSetBuilder;
 import hudson.util.StackedAreaRenderer2;
 
 import java.awt.Color;
+import java.net.URLEncoder;
 import java.util.ArrayList;
 import java.util.List;
 import java.util.Map;
@@ -109,7 +110,7 @@ public abstract class AbstractBuildStatChartDimension {
 	                boolean notBuildShown=Messages.Build_Results_Item_Legend_Statuses_NOT_BUILD().equals(status);
 	                
 	                StringBuilder sb = new StringBuilder()
-	                	.append("buildHistory?jobFilter=").append(config.getBuildFilters().getJobFilter())
+	                	.append("buildHistory?jobFilter=").append(URLEncoder.encode(config.getBuildFilters().getJobFilter()))
 	                	.append("&start=").append(range.getStart().getTimeInMillis())
 	                	.append("&end=").append(range.getEnd().getTimeInMillis())
 	                	.append("&successShown=").append(successShown)
@@ -118,10 +119,10 @@ public abstract class AbstractBuildStatChartDimension {
 	                	.append("&abortedShown=").append(abortedShown)
 	                	.append("&notBuildShown=").append(notBuildShown);
 	                if(config.getBuildFilters().getNodeFilter() != null){
-	                	sb.append("&nodeFilter=").append(config.getBuildFilters().getNodeFilter());
+	                	sb.append("&nodeFilter=").append(URLEncoder.encode(config.getBuildFilters().getNodeFilter()));
 	                }
 	                if(config.getBuildFilters().getLauncherFilter() != null){
-	                	sb.append("&launcherFilter=").append(config.getBuildFilters().getLauncherFilter());
+	                	sb.append("&launcherFilter=").append(URLEncoder.encode(config.getBuildFilters().getLauncherFilter()));
 	                }
 	                return sb.toString();
 	            }
