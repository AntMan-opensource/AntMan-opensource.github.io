commit 0b732f2ef0224e2aaf10e2e1ef48dbd3fb6e10cd
Author: Simon Urli <simon.urli@xwiki.com>
Date:   Thu Jun 9 14:40:38 2022 +0200

    XWIKI-19804: Bulletproof user API

diff --git a/xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/api/User.java b/xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/api/User.java
index c2f55f1b19a..c81b109e4c9 100644
--- a/xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/api/User.java
+++ b/xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/api/User.java
@@ -92,7 +92,9 @@ public XWikiUser getUser()
      */
     public void setDisabledStatus(boolean disabledStatus)
     {
-        this.user.setDisabled(disabledStatus, getXWikiContext());
+        if (hasAdminRights()) {
+            this.user.setDisabled(disabledStatus, getXWikiContext());
+        }
     }
 
     /**
