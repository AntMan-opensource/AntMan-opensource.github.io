commit 13d8805331012abffe3282c03d47320e940f1861
Author: fxbin <fxbin123@gmail.com>
Date:   Thu May 6 06:46:43 2021 +0800

    fix(code): Missing validation of JWT signature

diff --git a/bubble-fireworks-project/bubble-fireworks-plugins/bubble-fireworks-plugin-token/src/main/java/cn/fxbin/bubble/plugin/token/DoubleJwt.java b/bubble-fireworks-project/bubble-fireworks-plugins/bubble-fireworks-plugin-token/src/main/java/cn/fxbin/bubble/plugin/token/DoubleJwt.java
index aa76ab1..eb777b7 100644
--- a/bubble-fireworks-project/bubble-fireworks-plugins/bubble-fireworks-plugin-token/src/main/java/cn/fxbin/bubble/plugin/token/DoubleJwt.java
+++ b/bubble-fireworks-project/bubble-fireworks-plugins/bubble-fireworks-plugin-token/src/main/java/cn/fxbin/bubble/plugin/token/DoubleJwt.java
@@ -136,12 +136,11 @@ public class DoubleJwt {
      * @param token jwt token
      * @return cn.fxbin.bubble.plugin.token.model.TokenPayload
      */
-    @SuppressWarnings("unchecked")
     public TokenPayload parseToken(String token) {
         Map<String, Object> mapObj = (Map<String, Object>) Jwts.parserBuilder()
                 .setSigningKey(key)
                 .build()
-                .parse(token)
+                .parseClaimsJws(token)
                 .getBody();
 
         TokenPayload payload = BeanUtils.map2Object(mapObj, TokenPayload.class);
diff --git a/bubble-fireworks-project/bubble-fireworks-plugins/bubble-fireworks-plugin-token/src/main/java/cn/fxbin/bubble/plugin/token/SingleJwt.java b/bubble-fireworks-project/bubble-fireworks-plugins/bubble-fireworks-plugin-token/src/main/java/cn/fxbin/bubble/plugin/token/SingleJwt.java
index 32c162b..27dfbe2 100644
--- a/bubble-fireworks-project/bubble-fireworks-plugins/bubble-fireworks-plugin-token/src/main/java/cn/fxbin/bubble/plugin/token/SingleJwt.java
+++ b/bubble-fireworks-project/bubble-fireworks-plugins/bubble-fireworks-plugin-token/src/main/java/cn/fxbin/bubble/plugin/token/SingleJwt.java
@@ -169,7 +169,7 @@ public class SingleJwt {
     public TokenPayload parseToken(String token) {
         Map<String, Object> mapObj = (Map<String, Object>) Jwts.parserBuilder()
                 .setSigningKey(key).build()
-                .parse(token)
+                .parseClaimsJws(token)
                 .getBody();
 
         TokenPayload payload = BeanUtils.map2Object(mapObj, TokenPayload.class);
