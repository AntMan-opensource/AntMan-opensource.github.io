commit 5f03723ff0c940ec68cfc53a0c491ceba80d2417
Author: ZhangHongYin <46039728+SpriCoder@users.noreply.github.com>
Date:   Wed Jun 29 21:03:27 2022 +0800

    strength login check. (#6514)

diff --git a/server/src/main/java/org/apache/iotdb/db/service/basic/ServiceProvider.java b/server/src/main/java/org/apache/iotdb/db/service/basic/ServiceProvider.java
index d71e54e128..987acbc6d7 100644
--- a/server/src/main/java/org/apache/iotdb/db/service/basic/ServiceProvider.java
+++ b/server/src/main/java/org/apache/iotdb/db/service/basic/ServiceProvider.java
@@ -105,7 +105,8 @@ public abstract class ServiceProvider {
    * @return true: If logged in; false: If not logged in
    */
   public boolean checkLogin(long sessionId) {
-    boolean isLoggedIn = SESSION_MANAGER.getUsername(sessionId) != null;
+    Long currSessionId = SESSION_MANAGER.getCurrSessionId();
+    boolean isLoggedIn = currSessionId != null && currSessionId == sessionId;
     if (!isLoggedIn) {
       LOGGER.info("{}: Not login. ", IoTDBConstant.GLOBAL_DB_NAME);
     } else {
