commit 7827db39925d0fc8f5b95e013466987b513b3f3c
Author: Marco Tizzoni <marco.tizzoni@ecb.europa.eu>
Date:   Mon Jul 18 14:26:32 2022 +0200

    SECURITY-2402

diff --git a/src/main/java/jenkins/plugins/rhnpush/RhnPush.java b/src/main/java/jenkins/plugins/rhnpush/RhnPush.java
index be70f9a..8014281 100644
--- a/src/main/java/jenkins/plugins/rhnpush/RhnPush.java
+++ b/src/main/java/jenkins/plugins/rhnpush/RhnPush.java
@@ -7,6 +7,7 @@ import hudson.Proc;
 import hudson.model.AbstractBuild;
 import hudson.model.AbstractProject;
 import hudson.model.BuildListener;
+import hudson.model.Item;
 import hudson.model.Result;
 import hudson.tasks.BuildStepDescriptor;
 import hudson.tasks.BuildStepMonitor;
@@ -297,6 +298,7 @@ public class RhnPush extends Recorder {
 
     public FormValidation doCheckIncludes(@AncestorInPath AbstractProject project, @QueryParameter String value) throws IOException, InterruptedException {
       FilePath workspace = project.getWorkspace();
+      project.checkPermission(Item.WORKSPACE);
       if (workspace == null) {
         throw new IllegalStateException("Could not get a workspace.");
       }
