commit 7ce1b0796d6cbe1f41b969583bd49f33ae0efef0
Author: Stefan Bodewig <stefan.bodewig@innoq.com>
Date:   Wed Jun 30 22:01:22 2021 +0200

    potential integer overflow in check

diff --git a/src/main/java/org/apache/commons/compress/archivers/tar/TarUtils.java b/src/main/java/org/apache/commons/compress/archivers/tar/TarUtils.java
index d809125e5..ec12f17fc 100644
--- a/src/main/java/org/apache/commons/compress/archivers/tar/TarUtils.java
+++ b/src/main/java/org/apache/commons/compress/archivers/tar/TarUtils.java
@@ -741,13 +741,16 @@ protected static Map<String, String> parsePaxHeaders(final InputStream inputStre
                     while((ch = inputStream.read()) != -1) {
                         read++;
                         totalRead++;
+                        if (totalRead < 0 || (headerSize >= 0 && totalRead >= headerSize)) {
+                            break;
+                        }
                         if (ch == '='){ // end of keyword
                             final String keyword = coll.toString(CharsetNames.UTF_8);
                             // Get rest of entry
                             final int restLen = len - read;
                             if (restLen <= 1) { // only NL
                                 headers.remove(keyword);
-                            } else if (headerSize >= 0 && totalRead + restLen > headerSize) {
+                            } else if (headerSize >= 0 && restLen > headerSize - totalRead) {
                                 throw new IOException("Paxheader value size " + restLen
                                     + " exceeds size of header record");
                             } else {
