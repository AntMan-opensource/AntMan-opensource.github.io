commit e6b5f2bf2f441bd679d35db1bd6f9576b148e3cb
Author: Daniel Beck <daniel-beck@users.noreply.github.com>
Date:   Wed Oct 28 09:54:21 2020 +0100

    [SECURITY-1999]

diff --git a/src/main/java/hudson/plugins/active_directory/ActiveDirectoryStatus.java b/src/main/java/hudson/plugins/active_directory/ActiveDirectoryStatus.java
index ef19c3f..235366a 100644
--- a/src/main/java/hudson/plugins/active_directory/ActiveDirectoryStatus.java
+++ b/src/main/java/hudson/plugins/active_directory/ActiveDirectoryStatus.java
@@ -24,9 +24,11 @@ package hudson.plugins.active_directory;
  * THE SOFTWARE.
  */
 
+import edu.umd.cs.findbugs.annotations.NonNull;
 import edu.umd.cs.findbugs.annotations.SuppressFBWarnings;
 import hudson.Extension;
 import hudson.model.ManagementLink;
+import hudson.security.Permission;
 import hudson.security.SecurityRealm;
 import hudson.util.ListBoxModel;
 import jenkins.model.Jenkins;
@@ -37,6 +39,7 @@ import net.sf.json.JSONObject;
 import org.acegisecurity.userdetails.UserDetails;
 import org.kohsuke.accmod.Restricted;
 import org.kohsuke.accmod.restrictions.NoExternalUse;
+import org.kohsuke.stapler.StaplerProxy;
 
 import java.io.IOException;
 import java.util.Collections;
@@ -55,7 +58,7 @@ import java.util.List;
  * @since 2.1
  */
 @Extension
-public class ActiveDirectoryStatus extends ManagementLink {
+public class ActiveDirectoryStatus extends ManagementLink implements StaplerProxy {
 
     @Override
     public String getIconFileName() {
@@ -72,6 +75,12 @@ public class ActiveDirectoryStatus extends ManagementLink {
         return "ad-health";
     }
 
+    @NonNull
+    @Override
+    public Permission getRequiredPermission() {
+        return Jenkins.ADMINISTER;
+    }
+
     /**
      * Get the list of domains configured on the Security Realm
      *
@@ -135,6 +144,12 @@ public class ActiveDirectoryStatus extends ManagementLink {
         return model;
     }
 
+    @Override
+    public Object getTarget() {
+        Jenkins.get().checkPermission(getRequiredPermission());
+        return this;
+    }
+
     /**
      * ServerHealth of a SocketInfo
      */
