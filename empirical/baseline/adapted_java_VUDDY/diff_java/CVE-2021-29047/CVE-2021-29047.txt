commit db75fcaadeeb7b00fc6268e4d12cfce6a21e5305
Author: Stian Sigvartsen <stian.sigvartsen@liferay.com>
Date:   Wed Nov 11 12:33:41 2020 +0000

    LPS-122063 Incorrect attribute name used

diff --git a/modules/apps/captcha/captcha-api/src/main/java/com/liferay/captcha/simplecaptcha/SimpleCaptchaImpl.java b/modules/apps/captcha/captcha-api/src/main/java/com/liferay/captcha/simplecaptcha/SimpleCaptchaImpl.java
index c744ec07bdabf..7219f61c15c40 100644
--- a/modules/apps/captcha/captcha-api/src/main/java/com/liferay/captcha/simplecaptcha/SimpleCaptchaImpl.java
+++ b/modules/apps/captcha/captcha-api/src/main/java/com/liferay/captcha/simplecaptcha/SimpleCaptchaImpl.java
@@ -397,8 +397,10 @@ public class SimpleCaptchaImpl implements Captcha {
 
 		HttpSession httpSession = _getHttpSession(httpServletRequest);
 
-		String captchaText = (String)httpSession.getAttribute(
-			_getHttpSessionKey(WebKeys.CAPTCHA_TEXT, httpServletRequest));
+		String httpSessionKey = _getHttpSessionKey(
+			WebKeys.CAPTCHA_TEXT, httpServletRequest);
+
+		String captchaText = (String)httpSession.getAttribute(httpSessionKey);
 
 		if (captchaText == null) {
 			_log.error(
@@ -413,7 +415,7 @@ public class SimpleCaptchaImpl implements Captcha {
 			ParamUtil.getString(httpServletRequest, "captchaText"));
 
 		if (valid) {
-			httpSession.removeAttribute(WebKeys.CAPTCHA_TEXT);
+			httpSession.removeAttribute(httpSessionKey);
 		}
 
 		return valid;
