commit 7dc29066d70af52cb3aa143783e8d2cb863fa4f7
Author: sokratis.sidereas <sokratis.sidereas@6B9B043.internal.upstreamsystems.com>
Date:   Sat Aug 12 11:00:12 2023 +0300

    FIX : SECURITY-3122

diff --git a/src/main/java/com/jenkins/testresultsaggregator/TestResultsAggregator.java b/src/main/java/com/jenkins/testresultsaggregator/TestResultsAggregator.java
index 71df0d1..a7e227b 100644
--- a/src/main/java/com/jenkins/testresultsaggregator/TestResultsAggregator.java
+++ b/src/main/java/com/jenkins/testresultsaggregator/TestResultsAggregator.java
@@ -20,6 +20,7 @@ import org.kohsuke.stapler.DataBoundConstructor;
 import org.kohsuke.stapler.DataBoundSetter;
 import org.kohsuke.stapler.QueryParameter;
 import org.kohsuke.stapler.StaplerRequest;
+import org.kohsuke.stapler.interceptor.RequirePOST;
 
 import com.google.common.base.Strings;
 import com.jenkins.testresultsaggregator.data.Aggregated;
@@ -49,6 +50,7 @@ import hudson.tasks.Publisher;
 import hudson.util.FormValidation;
 import hudson.util.Secret;
 import hudson.util.VariableResolver;
+import jenkins.model.Jenkins;
 import jenkins.tasks.SimpleBuildStep;
 import net.sf.json.JSONObject;
 
@@ -385,7 +387,10 @@ public class TestResultsAggregator extends Notifier implements SimpleBuildStep {
 			}
 		}
 		
+		@RequirePOST
 		public FormValidation doTestApiConnection(@QueryParameter final String jenkinsUrl, @QueryParameter final String username, @QueryParameter final Secret password) {
+			// https://www.jenkins.io/doc/developer/security/form-validation/
+			Jenkins.get().checkPermission(Jenkins.ADMINISTER);
 			try {
 				new Collector(null, username, password, jenkinsUrl).getAPIConnection();
 				return FormValidation.ok(LocalMessages.SUCCESS.toString());
