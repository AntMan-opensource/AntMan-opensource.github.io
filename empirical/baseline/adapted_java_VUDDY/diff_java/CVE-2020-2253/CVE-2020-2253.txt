commit ac039ba581f5946975a327709ff201b459900caa
Author: Alex Earl <slide.o.mix@gmail.com>
Date:   Thu Sep 10 10:48:41 2020 +0200

    [SECURITY-1851]

diff --git a/src/main/java/hudson/plugins/emailext/ExtendedEmailPublisherDescriptor.java b/src/main/java/hudson/plugins/emailext/ExtendedEmailPublisherDescriptor.java
index e2f06227..9deaf670 100644
--- a/src/main/java/hudson/plugins/emailext/ExtendedEmailPublisherDescriptor.java
+++ b/src/main/java/hudson/plugins/emailext/ExtendedEmailPublisherDescriptor.java
@@ -300,6 +300,13 @@ public final class ExtendedEmailPublisherDescriptor extends BuildStepDescriptor<
                 props.put("mail.smtp.socketFactory.class", "javax.net.ssl.SSLSocketFactory");
             }
             props.put("mail.smtp.socketFactory.fallback", "false");
+
+            // RFC 2595 specifies additional checks that must be performed on the server's
+            // certificate to ensure that the server you connected to is the server you intended
+            // to connect to. This reduces the risk of "man in the middle" attacks.
+            if (props.getProperty("mail.smtp.ssl.checkserveridentity") == null) {
+                props.put("mail.smtp.ssl.checkserveridentity", "true");
+            }
         }
         if (!StringUtils.isBlank(acc.getSmtpUsername())) {
             props.put("mail.smtp.auth", "true");
