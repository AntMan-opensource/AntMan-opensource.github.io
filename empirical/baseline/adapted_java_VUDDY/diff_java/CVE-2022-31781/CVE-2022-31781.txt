commit 3c8d6103832eec3bc06029dd2532f06df717431f
Author: Thiago H. de Paula Figueiredo <thiago@arsmachina.com.br>
Date:   Sun Apr 17 23:50:16 2022 -0300

    Tweaking ContentType's parser regular expression.

diff --git a/tapestry-core/src/test/java/org/apache/tapestry5/root/ContentTypeTest.java b/tapestry-core/src/test/java/org/apache/tapestry5/root/ContentTypeTest.java
index 5be6bda94..00842acad 100644
--- a/tapestry-core/src/test/java/org/apache/tapestry5/root/ContentTypeTest.java
+++ b/tapestry-core/src/test/java/org/apache/tapestry5/root/ContentTypeTest.java
@@ -154,4 +154,11 @@ public class ContentTypeTest extends TestBase
         assertEquals(base.toString(), "text/html");
         assertEquals(charset.toString(), "text/html;charset=utf-8");
     }
+    
+    @Test(timeOut = 100, expectedExceptions = IllegalArgumentException.class)
+    public void constructor_timeout() throws Exception
+    {
+        new ContentType("a/a;a=:;a=:;a=:;a=:;a=:;a=:;a=:;a=:;a=:;a=:;a=:;a=:;a=:;a=:;a=:;a=:;a=:;a=:;a=:;a=:;a=:;a=:;a=:;a=:;a=:;a=:;a=:;a=:;a=:;a=:;");
+    }
+    
 }
diff --git a/tapestry-http/src/main/java/org/apache/tapestry5/http/ContentType.java b/tapestry-http/src/main/java/org/apache/tapestry5/http/ContentType.java
index bf5da4a24..bf1b75cf8 100644
--- a/tapestry-http/src/main/java/org/apache/tapestry5/http/ContentType.java
+++ b/tapestry-http/src/main/java/org/apache/tapestry5/http/ContentType.java
@@ -39,7 +39,7 @@ public final class ContentType
 
     private final Map<String, String> parameters;
 
-    private static final Pattern PATTERN = Pattern.compile("^(.+)/([^;]+)(;(.+=[^;]+))*$");
+    private static final Pattern PATTERN = Pattern.compile("^(.+)/([^;]+)(;(.+=[^;]+)){0,5}$");
 
     /**
      * Creates a new content type from the argument. The format of the argument has to be basetype/subtype(;key=value)*
