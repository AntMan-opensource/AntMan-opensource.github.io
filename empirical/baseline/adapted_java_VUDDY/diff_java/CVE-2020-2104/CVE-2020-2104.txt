commit 7d44836fad0f49341ae2a61de06dbb556014a2df
Author: Daniel Beck <daniel-beck@users.noreply.github.com>
Date:   Tue Jan 14 12:08:50 2020 +0100

    [SECURITY-1650]

diff --git a/core/src/main/java/hudson/diagnosis/MemoryUsageMonitor.java b/core/src/main/java/hudson/diagnosis/MemoryUsageMonitor.java
index 1ba648eb38..a953cc36a2 100644
--- a/core/src/main/java/hudson/diagnosis/MemoryUsageMonitor.java
+++ b/core/src/main/java/hudson/diagnosis/MemoryUsageMonitor.java
@@ -39,6 +39,7 @@ import java.util.List;
 import java.util.ArrayList;
 import java.io.IOException;
 
+import jenkins.model.Jenkins;
 import org.jenkinsci.Symbol;
 import org.kohsuke.stapler.QueryParameter;
 
@@ -102,6 +103,7 @@ public final class MemoryUsageMonitor extends PeriodicWork {
          * Generates the memory usage statistics graph.
          */
         public TrendChart doGraph(@QueryParameter String type) throws IOException {
+            Jenkins.get().checkPermission(Jenkins.ADMINISTER);
             return MultiStageTimeSeries.createTrendChart(TimeScale.parse(type),used,max);
         }
     }
