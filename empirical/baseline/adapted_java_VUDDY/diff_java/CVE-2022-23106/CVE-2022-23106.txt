commit 4f425675edf77d382a6fd10890f1a704ff3b2277
Author: Yaroslav Afenkin <yaroslav.afenkin@gmail.com>
Date:   Thu Dec 16 11:03:13 2021 +0200

    [SECURITY-2141]

diff --git a/plugin/src/main/java/io/jenkins/plugins/casc/TokenReloadAction.java b/plugin/src/main/java/io/jenkins/plugins/casc/TokenReloadAction.java
index df907054..49d46de2 100644
--- a/plugin/src/main/java/io/jenkins/plugins/casc/TokenReloadAction.java
+++ b/plugin/src/main/java/io/jenkins/plugins/casc/TokenReloadAction.java
@@ -6,6 +6,8 @@ import hudson.model.UnprotectedRootAction;
 import hudson.security.ACL;
 import hudson.security.ACLContext;
 import java.io.IOException;
+import java.nio.charset.StandardCharsets;
+import java.security.MessageDigest;
 import java.util.logging.Logger;
 import javax.servlet.http.HttpServletRequest;
 import org.kohsuke.stapler.StaplerRequest;
@@ -48,7 +50,8 @@ public class TokenReloadAction implements UnprotectedRootAction {
         } else {
             String requestToken = getRequestToken(request);
 
-            if (token.equals(requestToken)) {
+            if (requestToken != null && MessageDigest.isEqual(token.getBytes(StandardCharsets.UTF_8), requestToken.getBytes(
+                StandardCharsets.UTF_8))) {
                 LOGGER.info("Configuration reload triggered via token");
 
                 try (ACLContext ignored = ACL.as(ACL.SYSTEM)) {
