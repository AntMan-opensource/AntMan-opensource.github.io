commit 7aac20940e637cdd2e38d3afd3748704e4015782
Author: Jesse Glick <jglick@cloudbees.com>
Date:   Fri Oct 30 00:17:27 2020 +0100

    [SECURITY-2102]

diff --git a/src/main/java/org/csanchez/jenkins/plugins/kubernetes/pipeline/PodTemplateStep.java b/src/main/java/org/csanchez/jenkins/plugins/kubernetes/pipeline/PodTemplateStep.java
index 733f9192..ba92e2de 100755
--- a/src/main/java/org/csanchez/jenkins/plugins/kubernetes/pipeline/PodTemplateStep.java
+++ b/src/main/java/org/csanchez/jenkins/plugins/kubernetes/pipeline/PodTemplateStep.java
@@ -403,6 +403,9 @@ public class PodTemplateStep extends Step implements Serializable {
         public ListBoxModel doFillCloudItems() {
             ListBoxModel result = new ListBoxModel();
             result.add("—any—", "");
+            if (!Jenkins.get().hasPermission(Jenkins.ADMINISTER)) { // TODO track use of SYSTEM_READ and/or MANAGE in GlobalCloudConfiguration
+                return result;
+            }
             Jenkins.get().clouds
                     .getAll(KubernetesCloud.class)
                     .forEach(cloud -> result.add(cloud.name));
@@ -415,6 +418,9 @@ public class PodTemplateStep extends Step implements Serializable {
             ListBoxModel result = new ListBoxModel();
             result.add("—Default inheritance—", "<default>");
             result.add("—Disable inheritance—", " ");
+            if (!Jenkins.get().hasPermission(Jenkins.ADMINISTER)) { // TODO track use of SYSTEM_READ and/or MANAGE in GlobalCloudConfiguration
+                return result;
+            }
             Cloud cloud;
             if (cloudName == null) {
                 cloud = Jenkins.get().clouds.get(KubernetesCloud.class);
