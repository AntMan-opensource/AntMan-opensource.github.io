commit 2bb312d91f8dc20e7e1e2098584dbea65a9bffb6
Author: vaibhjai <vaibhav_jain2@bmc.com>
Date:   Mon May 16 15:04:21 2022 +0530

    SECURITY-2626: Added Missing permission checks.

diff --git a/src/main/java/com/compuware/jenkins/build/CodeCoverageBuilder.java b/src/main/java/com/compuware/jenkins/build/CodeCoverageBuilder.java
index f4ea0d2..5bbd331 100644
--- a/src/main/java/com/compuware/jenkins/build/CodeCoverageBuilder.java
+++ b/src/main/java/com/compuware/jenkins/build/CodeCoverageBuilder.java
@@ -252,6 +252,12 @@ public class CodeCoverageBuilder extends Builder implements SimpleBuildStep
 		public ListBoxModel doFillConnectionIdItems(@AncestorInPath Jenkins context, @QueryParameter String connectionId,
 				@AncestorInPath Item project)
 		{
+			if (project == null) {
+				Jenkins.get().checkPermission(Jenkins.ADMINISTER);
+			} else {
+				project.checkPermission(Item.CONFIGURE);
+			}
+
 			CpwrGlobalConfiguration globalConfig = CpwrGlobalConfiguration.get();
 			HostConnection[] hostConnections = globalConfig.getHostConnections();
 
@@ -288,6 +294,12 @@ public class CodeCoverageBuilder extends Builder implements SimpleBuildStep
 		public ListBoxModel doFillCredentialsIdItems(@AncestorInPath Jenkins context, @QueryParameter String credentialsId,
 				@AncestorInPath Item project)
 		{
+			if (project == null) {
+				Jenkins.get().checkPermission(Jenkins.ADMINISTER);
+			} else {
+				project.checkPermission(Item.CONFIGURE);
+			}
+
 			List<StandardCredentials> creds = CredentialsProvider.lookupCredentials(
 					StandardCredentials.class, project, ACL.SYSTEM,
 					Collections.<DomainRequirement> emptyList());
