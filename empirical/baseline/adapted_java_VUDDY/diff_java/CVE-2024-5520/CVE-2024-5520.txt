commit b05a5aca0f2b03042ddf2b2bb45fe2243a4084a7
Author: gWestenberger <g.westenberger@alkacon.com>
Date:   Tue Apr 2 16:07:38 2024 +0200

    Fixed XSS issue in site management.

diff --git a/src/org/opencms/ui/apps/sitemanager/CmsCreateSiteThread.java b/src/org/opencms/ui/apps/sitemanager/CmsCreateSiteThread.java
index c63e922fda..3a286b86d7 100644
--- a/src/org/opencms/ui/apps/sitemanager/CmsCreateSiteThread.java
+++ b/src/org/opencms/ui/apps/sitemanager/CmsCreateSiteThread.java
@@ -41,6 +41,7 @@ import org.opencms.file.types.CmsResourceTypeFolder;
 import org.opencms.file.types.CmsResourceTypeFolderSubSitemap;
 import org.opencms.file.types.CmsResourceTypeImage;
 import org.opencms.file.types.I_CmsResourceType;
+import org.opencms.i18n.CmsEncoder;
 import org.opencms.loader.CmsLoaderException;
 import org.opencms.lock.CmsLockException;
 import org.opencms.main.CmsException;
@@ -193,11 +194,11 @@ public class CmsCreateSiteThread extends A_CmsReportThread {
 
             if (m_oldSite == null) {
                 getReport().println(
-                    Messages.get().container(Messages.RPT_SITE_START_NEW_1, m_site.getTitle()),
+                    Messages.get().container(Messages.RPT_SITE_START_NEW_1, CmsEncoder.escapeXml(m_site.getTitle())),
                     I_CmsReport.FORMAT_HEADLINE);
             } else {
                 getReport().println(
-                    Messages.get().container(Messages.RPT_SITE_START_EDIT_1, m_site.getTitle()),
+                    Messages.get().container(Messages.RPT_SITE_START_EDIT_1, CmsEncoder.escapeXml(m_site.getTitle())),
                     I_CmsReport.FORMAT_HEADLINE);
             }
             CmsResource siteRootResource = null;
diff --git a/src/org/opencms/ui/apps/sitemanager/CmsDeleteSiteDialog.java b/src/org/opencms/ui/apps/sitemanager/CmsDeleteSiteDialog.java
index b35242c063..4946244847 100644
--- a/src/org/opencms/ui/apps/sitemanager/CmsDeleteSiteDialog.java
+++ b/src/org/opencms/ui/apps/sitemanager/CmsDeleteSiteDialog.java
@@ -28,6 +28,7 @@
 package org.opencms.ui.apps.sitemanager;
 
 import org.opencms.file.CmsResource;
+import org.opencms.i18n.CmsEncoder;
 import org.opencms.lock.CmsLockException;
 import org.opencms.main.CmsException;
 import org.opencms.main.CmsLog;
@@ -134,14 +135,14 @@ public class CmsDeleteSiteDialog extends CmsBasicDialog {
         if (m_sitesToDelete.size() == 1) {
             message = CmsVaadinUtils.getMessageText(
                 Messages.GUI_SITE_CONFIRM_DELETE_SITE_1,
-                m_sitesToDelete.get(0).getTitle());
+                CmsEncoder.escapeXml(m_sitesToDelete.get(0).getTitle()));
         } else {
             message = "";
             for (CmsSite site : m_sitesToDelete) {
                 if (message.length() > 0) {
                     message += ", ";
                 }
-                message += site.getTitle();
+                message += CmsEncoder.escapeXml(site.getTitle());
             }
             message = CmsVaadinUtils.getMessageText(Messages.GUI_SITE_CONFIRM_DELETE_SITES_1, message);
         }
