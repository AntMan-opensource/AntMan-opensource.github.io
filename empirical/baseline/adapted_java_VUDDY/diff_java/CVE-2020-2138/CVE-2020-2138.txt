commit fdee535fe4782181d822b875c96df8306f245d48
Author: Federico Pellegrin <fede@evolware.org>
Date:   Tue Mar 3 04:55:52 2020 +0100

    [SECURITY-1700]

diff --git a/src/main/java/hudson/plugins/cobertura/CoberturaCoverageParser.java b/src/main/java/hudson/plugins/cobertura/CoberturaCoverageParser.java
index faeead6..5d60b8e 100644
--- a/src/main/java/hudson/plugins/cobertura/CoberturaCoverageParser.java
+++ b/src/main/java/hudson/plugins/cobertura/CoberturaCoverageParser.java
@@ -66,6 +66,8 @@ public class CoberturaCoverageParser {
         factory.setValidating(false);
         try {
             factory.setFeature("http://apache.org/xml/features/nonvalidating/load-external-dtd", false);
+            factory.setFeature("http://xml.org/sax/features/external-general-entities", false);
+            factory.setFeature("http://xml.org/sax/features/external-parameter-entities", false);
         } catch (ParserConfigurationException e) {
         } catch (SAXNotRecognizedException e) {
         } catch (SAXNotSupportedException e) {
diff --git a/src/main/java/hudson/plugins/cobertura/CoberturaPublisher.java b/src/main/java/hudson/plugins/cobertura/CoberturaPublisher.java
index c6d7693..932e702 100644
--- a/src/main/java/hudson/plugins/cobertura/CoberturaPublisher.java
+++ b/src/main/java/hudson/plugins/cobertura/CoberturaPublisher.java
@@ -896,7 +896,8 @@ public class CoberturaPublisher extends Recorder implements SimpleBuildStep {
             FilePath[] r = new FilePath(f).list(reportFilePath);
 
             XMLInputFactory factory = XMLInputFactory.newInstance();
-            factory.setProperty("javax.xml.stream.supportDTD", false);
+            factory.setProperty(XMLInputFactory.SUPPORT_DTD, false);
+            factory.setProperty("javax.xml.stream.isSupportingExternalEntities", false);
 
             for (FilePath filePath : r) {
                 InputStream is = null;
