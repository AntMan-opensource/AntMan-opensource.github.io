commit a6ca8c73a26cf5caa6cab713d6a5bee7950f0a2d
Author: Iván Zaera Avellón <ivan.zaera@liferay.com>
Date:   Tue Jun 21 11:00:40 2022 +0200

    LPS-147618 Escape URL fields to avoid XSS attacks
    
    This implementation is very safe, because it makes any data read from DB be
    escaped. The "downside" is that the real data the user typed in the UI
    won't ever be accessible, but I don't think we need that for anything...

diff --git a/modules/apps/client-extension/client-extension-type-impl/src/main/java/com/liferay/client/extension/type/internal/BaseCETImpl.java b/modules/apps/client-extension/client-extension-type-impl/src/main/java/com/liferay/client/extension/type/internal/BaseCETImpl.java
index 10742cf15924e..e281fe5478a9c 100644
--- a/modules/apps/client-extension/client-extension-type-impl/src/main/java/com/liferay/client/extension/type/internal/BaseCETImpl.java
+++ b/modules/apps/client-extension/client-extension-type-impl/src/main/java/com/liferay/client/extension/type/internal/BaseCETImpl.java
@@ -21,6 +21,7 @@ import com.liferay.petra.reflect.ReflectionUtil;
 import com.liferay.petra.string.CharPool;
 import com.liferay.petra.string.StringPool;
 import com.liferay.portal.kernel.util.GetterUtil;
+import com.liferay.portal.kernel.util.HtmlUtil;
 import com.liferay.portal.kernel.util.PropertiesUtil;
 import com.liferay.portal.kernel.util.StringUtil;
 import com.liferay.portal.kernel.util.UnicodeProperties;
@@ -221,7 +222,7 @@ public abstract class BaseCETImpl implements CET {
 			String value = entry.getValue();
 
 			if (isURLCETPropertyName(name)) {
-				value = _transform(baseURL, value);
+				value = HtmlUtil.escapeHREF(_transform(baseURL, value));
 			}
 
 			transformedUnicodeProperties.put(name, value);
