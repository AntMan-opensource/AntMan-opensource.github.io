commit d4ea89e978d44a0991c41e410c6f5b073655b56b
Author: Eric Zhao <sczyh16@gmail.com>
Date:   Fri Nov 19 16:41:56 2021 +0800

    dashboard: Add IP validation in MachineRegistryController
    
    * Fixes #2451
    
    Signed-off-by: Eric Zhao <sczyh16@gmail.com>

diff --git a/sentinel-dashboard/src/main/java/com/alibaba/csp/sentinel/dashboard/controller/MachineRegistryController.java b/sentinel-dashboard/src/main/java/com/alibaba/csp/sentinel/dashboard/controller/MachineRegistryController.java
index d11815d2..6552d1ce 100755
--- a/sentinel-dashboard/src/main/java/com/alibaba/csp/sentinel/dashboard/controller/MachineRegistryController.java
+++ b/sentinel-dashboard/src/main/java/com/alibaba/csp/sentinel/dashboard/controller/MachineRegistryController.java
@@ -29,6 +29,7 @@ import org.springframework.stereotype.Controller;
 import org.springframework.web.bind.annotation.RequestMapping;
 import org.springframework.web.bind.annotation.RequestParam;
 import org.springframework.web.bind.annotation.ResponseBody;
+import sun.net.util.IPAddressUtil;
 
 @Controller
 @RequestMapping(value = "/registry", produces = MediaType.APPLICATION_JSON_VALUE)
@@ -51,6 +52,9 @@ public class MachineRegistryController {
         if (StringUtil.isBlank(ip) || ip.length() > 128) {
             return Result.ofFail(-1, "invalid ip: " + ip);
         }
+        if (!IPAddressUtil.isIPv4LiteralAddress(ip) && !IPAddressUtil.isIPv6LiteralAddress(ip)) {
+            return Result.ofFail(-1, "invalid ip: " + ip);
+        }
         if (port == null || port < -1) {
             return Result.ofFail(-1, "invalid port");
         }
