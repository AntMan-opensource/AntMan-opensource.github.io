--- CVE-2020-1695.txt_ClientHeadersRequestFilter.java_1_OLD.vul	2024-12-25 17:17:31.346534028 +0800
+++ CVE-2020-1695.txt_ClientHeadersRequestFilter.java_1_NEW.vul	2024-12-25 17:17:31.346534028 +0800
@@ -7,7 +7,7 @@
         Optional<ClientHeaderProvider> handler = ClientHeaderProviders.getProvider(method);
         handler.ifPresent(h -> h.addHeaders(headers));
 
-        Optional<ClientHeadersFactory> factory = ClientHeaderProviders.getFactory(method.getDeclaringClass());
+        Optional<ClientHeadersFactory> factory = ClientHeaderProviders.getFactory(ClientRequestContextUtils.getDeclaringClass(requestContext));
 
         requestContext.getHeaders().forEach(
                 (key, values) -> headers.put(key, castToListOfStrings(values))
